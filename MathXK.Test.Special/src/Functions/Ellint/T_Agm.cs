//  Copyright (c) 2015 Rocco Romeo
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace MathXK.Test.Functions
{
    [TestClass]
    public class T_Agm
    {

        private struct AgmData
        {
            public readonly double A;
            public readonly double B;
            public readonly double Result;

            public AgmData(double a, double b, double result)
            {
                A = a;
                B = b;
                Result = result;
            }
        }

        #region Test Cases

        static readonly AgmData[] _Agm_Spot = {
            new AgmData(0, 0, 0),
            new AgmData(0, 1, 0),
            new AgmData(0, 2, 0),
            new AgmData(0, double.PositiveInfinity, 0 ),

            new AgmData(double.PositiveInfinity, 5, double.PositiveInfinity ),

            new AgmData(7, 13, 9.7683385149310601516448087023475175558613492627641691674622676002990801),
            new AgmData(10, 11, 10.494043395822144360396369201529130277953396956361412822996899680667106),
            new AgmData(12, 0.75, 4.5289937553128952385888785425638712814637796581056451086261606413491579),
            new AgmData(0.75, 0.5,0.61867010905907611565166490089785037231291852351668396670654568515762147),


            new AgmData(1e-308, 1e-308, 1.00000000000000000000000000000000000000000000000000000000000000000000000e-308),
            new AgmData(1e-308, 1e-300, 7.9305210334345310798080316170174595231963304928088718103283402973775741e-302),
            new AgmData(1e-308, 1e-150, 4.3012567236404201422019879224076955713559794691765367662303357653100970e-153),
            new AgmData(1e-308, 1e-10, 2.2846063986991009584980105388686293089988946541768039172895536063176145e-13 ),

            new AgmData(1e-308, 1e10, 2.1411919839422543945791004831468261720086744507814659505171315636288933e7),
            new AgmData(1e-308, 1e150,1.4875384051563585709538489263316410009349987377189214015537567186954262e147 ),
            new AgmData(1e-308, 1e300,1.1209100687740709389255913434346212621317286965208549229428661780253691e297 ),
            new AgmData(1e-308, 1e308,1.1063670091055406627344795547373356075070289179226674480773697461402188e305 ),

            new AgmData(1e308, 1e-300, 1.1209100687740709389255913434346212621317286965208549229428661780253691e305),
            new AgmData(1e308, 1e-150, 1.4875384051563585709538489263316410009349987377189214015537567186954262e305),
            new AgmData(1e308, 1e-10, 2.1411919839422543945791004831468261720086744507814659505171315636288933e305),

            new AgmData(1e308, 1e10,2.2846063986991009584980105388686293089988946541768039172895536063176145e305 ),
            new AgmData(1e308, 1e150,4.3012567236404201422019879224076955713559794691765367662303357653100970e305),
            new AgmData(1e308, 1e300,7.9305210334345310798080316170174595231963304928088718103283402973775741e306),
            new AgmData(1e308, 1e308,1.00000000000000000000000000000000000000000000000000000000000000000000000e308),

            new AgmData(Math.Pow(2,1023)*(1+0.5), Math.Pow(2,1023)*(1+0.75),1.4584609748008672950484436607116338142851634180477178174e308),
            new AgmData(Math.Pow(2,-1022)*(1+0.5), Math.Pow(2,-1022)*(1+0.75),3.610386362109444648959357839296129318292397073768603706e-308),

            new AgmData(double.MaxValue, double.MaxValue/2, double.MaxValue * 0.728395515523453434593216191632540987486931971610652795397086),
            new AgmData(double.MaxValue, double.MaxValue*(1-Math.Pow(2,-52)), double.MaxValue * 0.99999999999999988897769753748434287614892217134026174655240),

            // check denorm behavior ( can't really expect accurate results here, but don't fail)
            new AgmData(double.Epsilon, 2*double.Epsilon, double.Epsilon * 1.456791031046906869186432383265081974973863943221305590794172),
            new AgmData(Math.Pow(2,-1022), Math.Pow(2,-1022)/8, Math.Pow(2,-1022) * 0.451969522199670343591649113312765076455415570183069541126350),
                                                 };


        static readonly AgmData[] _Agm_A1_Bgt2 = {

            new AgmData(1,2.0, 1.4567910310469068691864323832650819749738639432213055907941723832679265),
            new AgmData(1,2.5,  1.6644985716365535646009487383353537324550994081051276431199008171007363),
            new AgmData(1,3.0, 1.8636167832448965423556890310242705951575328568268537222204412269783258),
            new AgmData(1,3.5,  2.0560416508029046870646193324622441798592642504648013195592573740219931),
            new AgmData(1,4.0, 2.2430285802876025701278021928290665405089731424066099759188237013874048),
            new AgmData(1,4.5,  2.4254649287878109467403321397360444177363108021763093847447708720247084),
            new AgmData(1,5.0, 2.6040081905309402886964274487250343309270652556376494877484132544556793),
            new AgmData(1,5.5,  2.7791632377336684429828414947306591282978299418726464917034327577009381),
            new AgmData(1,6.0, 2.9513287423905727602192706351770905041206549229468061344666979951981855),
            new AgmData(1,6.5,  3.1208266866640540674640578269835607444533147094106422978522765958367168),
            new AgmData(1,7.0, 3.2879219818264181062230987140726123446436500105692535400462172657366085),
            new AgmData(1,7.5,  3.4528359971343319436131305462974464305263943323108618292650104327068390),
            new AgmData(1,8.0, 3.6157561775973627487331929065021206116433245614645563290108029994589752),
            new AgmData(1,8.5,  3.7768430597494287491420158644109950059950588108726583236242712196973422),
            new AgmData(1,9.0, 3.9362355036495554779789261755007478978278976407371639424582012263495990),
            new AgmData(1,9.5,  4.0940546700697810368659294155729488208988644822938418709329014710884148),
            new AgmData(1,10.0, 4.2504070949322748617281643183731348667984678641901928596701476622237553),
            new AgmData(1,10.5,  4.4053871013519198072705856243834340080325631063202477323068864571591727),
            new AgmData(1,11.0, 4.5590787170911606695975758446613161367950845480145417105424276677512886),
            new AgmData(1,11.5,  4.7115572169323951205040884953449015817295318974145479569939505408731931),
            new AgmData(1,12.0, 4.8628903765982519777418089096360412983691862489160105620491781109996547),
            new AgmData(1,12.5,  5.0131395020286122586053155256729924718642578420156631822950840156720547),
            new AgmData(1,13.0, 5.1623602816964704220359210773423397870767347390611289685292710511275463),
            new AgmData(1,13.5,  5.3106034980637670023140861285429009096507914866719547536112269924563804),
            new AgmData(1,14.0, 5.4579156258390047044726924701419942958336564113328503649025390338836782),
            new AgmData(1,14.5,  5.6043393384656009569646758025908883860138559357288187047802528878041760),
            new AgmData(1,15.0, 5.7499139396097224149387364623965615392397404217018916498346234587560350),
            new AgmData(1,15.5,  5.8946757328923184130770514980450859800067198416551948784126548036919933),
            new AgmData(1,16.0, 6.0386583404171936514518380567518283752850395441408601448348808551322106),
            new AgmData(1,16.5,  6.1818929785691569947252822868300614474455058910191596207655652356635434),
            new AgmData(1,17.0, 6.3244086979385504730967813135429325069924306654784925431992597118805254),
            new AgmData(1,17.5,  6.4662325929583054983099894971740209787361353137672344650378945878083130),
            new AgmData(1,18.0, 6.6073899858345559182215204867494134976918201545521301959142662324119973),
            new AgmData(1,18.5,  6.7479045885505870602863764259351457939612757958052921257953820154238672),
            new AgmData(1,19.0, 6.8877986460807450268459581545691983990812864150130082259042966888236916),
            new AgmData(1,19.5,  7.0270930634313175856934808669412851199783685979283799764034842101469033),
            new AgmData(1,20.0, 7.1658075187030228420894705996166040451676201060650400602911867626648822),
            new AgmData(1,20.5,  7.3039605640244219215095460387848582128495611042012965297053888221074647),
            new AgmData(1,21.0, 7.4415697159217061241660293995610155469624989089534413136662441226230918),
            new AgmData(1,21.5,  7.5786515364557530126977173390287415644599888156084940028427380420098056),
            new AgmData(1,22.0, 7.7152217062625829952123248262731358461205768912190545807280615414004765),
            new AgmData(1,22.5,  7.8512950904708735819053744305329784200919447708812824442064647503524716),
            new AgmData(1,23.0, 7.9868857983340492511106762223269215852350833447171180154420940301703202),
            new AgmData(1,23.5,  8.1220072372999110645997316643970798185100208499406425150775221682676762),
            new AgmData(1,24.0, 8.2566721621439919065308436843708369257664325791255050690093044556632020),
            new AgmData(1,24.5,  8.3908927197107486260898149941390677458967698315966521329542488997994888),
            new AgmData(1,25.0, 8.5246804897368424642307824058110340392048383769446573988365373254440510),
            new AgmData(1,25.5,  8.6580465221710877617845237039492039018616276965177535892789033467232184),
            new AgmData(1,26.0, 8.7910013713545092325125979006590897737526410715222257755366020518370455),
            new AgmData(1,26.5,  8.9235551273799793751134537372716987809025582444452785817580319285271408),
            new AgmData(1,27.0, 9.0557174449129878589707647804130165316454579779419070895098052956042725),
            new AgmData(1,27.5,  9.1874975697222950416423328443530820827654031256019028287344097824987353),
            new AgmData(1,28.0, 9.3189043631407702236007795607563115659564373164765297454357703314175833),
            new AgmData(1,28.5,  9.4499463246519679887254421770049129679320541582359345547875420718315045),
            new AgmData(1,29.0, 9.5806316127764141582918239851483238566661071596597960494951029619815266),
            new AgmData(1,29.5,  9.7109680644127039798869561717138786396657318538015978139290484705311467),
            new AgmData(1,30.0, 9.8409632127719779318457285370547537505774174064091989778997903334966309),

            new AgmData(1,32.0, 10.357671709098913198129629547064615638265973190006001095336406557455302),
            new AgmData(1,35.5,11.250279063052409579398424212436459668764386940014341594277688939064701),
            new AgmData(1,39.0, 12.129648768082963002649366830958162701834588026704950568327076135079102),
            new AgmData(1,42.5,12.997278313286012564429176689329899437657539782850548507213141730877437),
            new AgmData(1,46.0, 13.854385435931824723529799219393903116764852926027475050365467903058074),
            new AgmData(1,49.5,14.701977735953867853615283281422372501578824517099446672444858390712288),
            new AgmData(1,53.0, 15.540901265310491801835192787236498394078210035460373863009123424285631),
            new AgmData(1,56.5,16.371875412717672267265352805043716657710666049482637613713351794079777),
            new AgmData(1,60.0, 17.195518559232812000840994225332016297524585897934109082266566666307503),
            new AgmData(1,63.5,18.012367342574619798900047751661851603454398612451228413425393796494019),
            new AgmData(1,67.0, 18.822891387018097613789477681213364103433535919598045741475686837862607),
            new AgmData(1,70.5,19.627504747379995307382809882109542983074258007472558673572185218765234),
            new AgmData(1,74.0, 20.426574926906640507432486353747193740496890737429825438542163937838311),
            new AgmData(1,77.5,21.220430073857691126459061363394855444538680722410274615100754442403919),
            new AgmData(1,81.0, 22.009364790303386636894905669389223364840688373769128939717905583946577),
            new AgmData(1,84.5,22.793644869188169129379364642706073986087091676919017660043694215167724),
            new AgmData(1,88.0, 23.573511193624419011835414949006109269912685833819757314867477901730137),
            new AgmData(1,91.5,24.349182974029263812258507259592554249515438187307037786074378651063766),
            new AgmData(1,95.0, 25.120860456594814566442571122535465603335740155230975279502476072944535),
            new AgmData(1,98.5,25.888727205742833735326829498248938483697600604483323132389812065430566),
            new AgmData(1,102.0, 26.652952040342789230252276326873304785842219135009370676566541647770195),
            new AgmData(1,105.5,27.413690686306403339364263490328306813511984378513810168435387479596681),
            new AgmData(1,109.0, 28.171087195146485563845202625830343663752653025059611836055486287329629),
            new AgmData(1,112.5,28.925275168103439734932101911869124600800466171984361338142156517161350),
            new AgmData(1,116.0, 29.676378817716900561472264641677364056362350901325331888000916938034073),
            new AgmData(1,119.5,30.424513892688891710208499476004854279671797392595817119498699539974282),
            new AgmData(1,123.0, 31.169788487138144170543950706330621974092985163442106854382489128748718),
            new AgmData(1,126.5,31.912303751580513323361983609047919520415124875199747796442480519480446),

            new AgmData(1,128,32.229703597193334799333271749162544924011351450323190014715309128382719),
            new AgmData(1,256,58.014020435579236761350375911616540957521495643006745813955778288629229),
            new AgmData(1,512,105.48029408178858152398658477547261134743536284872157542144958339006582),
            new AgmData(1,1024,193.38065882208349156674718906655086350112712254858406434273108456275188),


            new AgmData(1,Math.Pow(2,10), 193.38065882208349156674718906655086350112712254858406434273108456275188),
            new AgmData(1,Math.Pow(2,26), 5.4314560778018186581705771009242210619812781042898395488869323377633461e6),
            new AgmData(1,Math.Pow(2,42), 2.2651739441852182220572564881178736542393879328873652121506816298166965e11),
            new AgmData(1,Math.Pow(2,58), 1.0886365571115647169387919957811018589163488455498130515588044002584820e16),
            new AgmData(1,Math.Pow(2,74), 5.6324909531734346281026846501718651291164633463198071311086398879774327e20),
            new AgmData(1,Math.Pow(2,90), 3.0493424413201347930258318623650450908407627392367808305031004066328804e25),

            new AgmData(1,Math.Pow(2,154), 3.3173336179155484380848408885903686970492047727627897712161815385141928e44),
            new AgmData(1,Math.Pow(2,218), 4.3392112109368059246788599146588193881934428896213507041474164536371334e63),
            new AgmData(1,Math.Pow(2,282), 6.2006162365432978151448752242641221035070797750594772072403026059920005e82),
            new AgmData(1,Math.Pow(2,346), 9.3345561354608775399615201664067907516238925848818114946035447662009837e101),
            new AgmData(1,Math.Pow(2,410), 1.4544387011950893905686794835598373857110001084679110687884779626375631e121),
            new AgmData(1,Math.Pow(2,474), 2.3222309450924086167960843517874530008337611947274444190292998918410164e140),
            new AgmData(1,Math.Pow(2,538), 3.7760551044266889313112192187033071164358092066265051303991638460499241e159),
            new AgmData(1,Math.Pow(2,602), 6.2275162159892735262236273655480892949061214590076370840614514088562158e178),
            new AgmData(1,Math.Pow(2,666), 1.0387118009302856155910537867859044838057184374037309769247416740843364e198),
            new AgmData(1,Math.Pow(2,730), 1.7485585118050207236716577285693514406809114097698059592424169383772945e217),
            new AgmData(1,Math.Pow(2,794), 2.9661827536817988001643245666913494670426126611480326383734348225781550e236),
            new AgmData(1,Math.Pow(2,858), 5.0644494941724748565191010079562674005179022213360849057762633820544076e255),
            new AgmData(1,Math.Pow(2,922), 8.6951774000190038693613759827264679741495262292147053480378323061325775e274),
            new AgmData(1,Math.Pow(2,986), 1.5000757697212155777980655950360978543094967723311367393287159560521337e294),

                                                 };

        static readonly AgmData[] _Agm_A1_PowersOfMinus2B = {

            new AgmData(1,Math.Pow(2,-1), 0.72839551552345343459321619163254098748693197161065279539708619163396323),
            new AgmData(1,Math.Pow(2,-2), 0.56075714507190064253195054820726663512724328560165249397970592534685120),
            new AgmData(1,Math.Pow(2,-3), 0.45196952219967034359164911331276507645541557018306954112635037493237190),
            new AgmData(1,Math.Pow(2,-4), 0.37741614627607460321573987854698927345531497150880375905218005344576316),
            new AgmData(1,Math.Pow(2,-5), 0.32367724090934103744155092334576923869581166218768753422926270492047820),
            new AgmData(1,Math.Pow(2,-6), 0.28325833606561509077587448937246600894516403134854253303189326419170170),
            new AgmData(1,Math.Pow(2,-7), 0.25179455935307292811979118554033238221883868320564992198996335256548999),
            new AgmData(1,Math.Pow(2,-8), 0.22661726732648139359902490590475211311531834235549510083576475893995792),
            new AgmData(1,Math.Pow(2,-9), 0.20601619937849332328903629838959494403795969306390932699501871755872231),
            new AgmData(1,Math.Pow(2,-10), 0.18884829963094090973315155182280357763781945561385162533469832476831238),
            new AgmData(1,Math.Pow(2,-11), 0.17432153467914384517548849993735194204373623157523383805557687664178566),
            new AgmData(1,Math.Pow(2,-12), 0.16187000290176684667096150229545945948877962228496266088774201586768793),
            new AgmData(1,Math.Pow(2,-13), 0.15107867088555894565277006051956059212554039802503247524478909254186087),
            new AgmData(1,Math.Pow(2,-14), 0.14163625431208479773714023363747411988922845361640993640369814871573064),
            new AgmData(1,Math.Pow(2,-15), 0.13330471002533754553649398164749530868016381206603189768185315376747851),
            new AgmData(1,Math.Pow(2,-16), 0.12589889282179224094296806924508025301166129380744616710159716044374775),
            new AgmData(1,Math.Pow(2,-17), 0.11927263530963808691392601282039653219915717591015229328136074809531311),
            new AgmData(1,Math.Pow(2,-18), 0.11330900354529736456830969047442889494976500227783529217771984595790919),
            new AgmData(1,Math.Pow(2,-19), 0.10791333671007987722241452580515318800991881202010475228734267880446136),
            new AgmData(1,Math.Pow(2,-20), 0.10300818504150524659031222115520538643494902668199041431485800670128446),
            new AgmData(1,Math.Pow(2,-21), 0.098529568300585920329389452080591065780857954301290158159928905428680767),
            new AgmData(1,Math.Pow(2,-22), 0.094424169621398609847323985617290713883257148986204614615120776439655076),
            new AgmData(1,Math.Pow(2,-23), 0.090647202836543572733421928569323017260107188074435850373823223020715294),
            new AgmData(1,Math.Pow(2,-24), 0.087160771958215192451033004864071963434752815292761227792017355055493232),
            new AgmData(1,Math.Pow(2,-25), 0.083932595219022089944739738656578001455993411086695714051498237510046872),
            new AgmData(1,Math.Pow(2,-26), 0.080935002532628456624903933717671350568253965739754431678160016801407130),
            new AgmData(1,Math.Pow(2,-27), 0.078144140376330926721683849290261768706679661966037517469568008107062663),
            new AgmData(1,Math.Pow(2,-28), 0.075539335697119896577651701423550467392283943474186575400266890314367460),
            new AgmData(1,Math.Pow(2,-29), 0.073102582932696674288378053639508209530182690315816301818422003861549733),
            new AgmData(1,Math.Pow(2,-30), 0.070818127216049903260768636359844587082676016087818341431380028405383676),
            new AgmData(1,Math.Pow(2,-31), 0.068672123361018088021101889680231547849425036686748546299611041550956752),

            new AgmData(1,Math.Pow(2,-32), 0.066652355026870497199542123637191631167606593036016823200103396929990666),
            new AgmData(1,Math.Pow(2,-48), 0.045323601418271938096276829457027778604217268823414249500842065514008952),
            new AgmData(1,Math.Pow(2,-64), 0.034336061680509044012330931406944445531580336383935308139521611494460462),
            new AgmData(1,Math.Pow(2,-80), 0.027636342328214596400168798449491870793730862608067280078546490895444424),
            new AgmData(1,Math.Pow(2,-96), 0.023124286437893845967488178294472789847815619733284671347886932110530226),
            new AgmData(1,Math.Pow(2,-112), 0.019878772551873657059770539235599415834087111700542963088535160297984910),


            new AgmData(1,Math.Pow(2,-128), 0.017432154391643053113952626714294872346814851798937675323792371338233081),
            new AgmData(1,Math.Pow(2,-192), 0.011681340571719571674298151921950172191164591411659266969551589041084023),
            new AgmData(1,Math.Pow(2,-256), 0.0087836436857116159101311684994509046708757005188445650856318150153887615),
            new AgmData(1,Math.Pow(2,-320), 0.0070378263071850835553224890461438925623786668753475086710962989874854052),
            new AgmData(1,Math.Pow(2,-384), 0.0058709328262010282508130608105138171116215822120774554199300732486277214),
            new AgmData(1,Math.Pow(2,-448), 0.0050359557131413264551418699396851853446354016308042173157622406088228899),
            new AgmData(1,Math.Pow(2,-512), 0.0044089106438007721883537771845492867803228224394200346149669421672573939),
            new AgmData(1,Math.Pow(2,-576), 0.0039207267662864998353180648319348328807715064599686813011989762525437725),
            new AgmData(1,Math.Pow(2,-640), 0.0035298754998654157395854228549195224378285525449562270904875518286141752),
            new AgmData(1,Math.Pow(2,-704), 0.0032098867859965961824558661088644949080537262519290336998484536458502840),
            new AgmData(1,Math.Pow(2,-768), 0.0029430910011864894867712226920238096169947152387816854442766341220393513),
            new AgmData(1,Math.Pow(2,-832), 0.0027172422912633056412635988883193446104147850525922035876414967313792572),
            new AgmData(1,Math.Pow(2,-896), 0.0025235858250708206066969281434948033464208582782426478753819691246885306),
            new AgmData(1,Math.Pow(2,-960), 0.0023556965394112233937773819884182259928128178106672534221341042348963622),
                                                       
                                                       };

        static readonly AgmData[] _Agm_A1_BNear1 = {

            // 1-2

            new AgmData(1,1.00781250,1.0039024501279358614064878719483823312034495940428416201863236480060090),
            new AgmData(1,1.01562500,1.0077973592117923295013467905734477003341488021695797448731808680528006),
            new AgmData(1,1.02343750,1.0116848139728743190509762092363430148605304741404542905237814731628694),
            new AgmData(1,1.03125000,1.0155648994005933248614639741734556388444985216875971610385140067852949),
            new AgmData(1,1.03906250,1.0194376988007375200908695305783423043544913181835639324602571996087872),
            new AgmData(1,1.04687500,1.0233032938420345018560071415567074537488890655203027676483139523918673),
            new AgmData(1,1.05468750,1.0271617646010794434174326496663313130613512421156376810192931171899230),
            new AgmData(1,1.06250000,1.0310131896056977968548272439891501808633174849162037997486407536307888),
            new AgmData(1,1.07031250,1.0348576458768082795369364262296121294281916900969325661411745422305539),
            new AgmData(1,1.07812500,1.0386952089688486588476023895641552473872895190246251236402905696292301),
            new AgmData(1,1.08593750,1.0425259530088238104669347018495303451351378397484089042213390691778972),
            new AgmData(1,1.09375000,1.0463499507340326547816087102912075998289144657600982735798762817405327),
            new AgmData(1,1.10156250,1.0501672735285278632462585273054446034703020872396513746068167844273305),
            new AgmData(1,1.10937500,1.0539779914583596619938334688388861568906352594383223747120797193312790),
            new AgmData(1,1.11718750,1.0577821733056526346166672128842997566670778653093797026407601599299881),
            new AgmData(1,1.12500000,1.0615798866015621313473719017738929041436560033209284238301974799390495),
            new AgmData(1,1.13281250,1.0653711976581547199647908609319662022646735023703355512570385438563418),
            new AgmData(1,1.14062500,1.0691561715992550572681731728832097371565411974966824411126722533520959),
            new AgmData(1,1.14843750,1.0729348723902996120246571602876449870249315717296748882363877178286769),
            new AgmData(1,1.15625000,1.0767073628672358244768243386214047227263541917796497803578062238679302),
            new AgmData(1,1.16406250,1.0804737047645035377950790270411371227854257193429767860942650820530398),
            new AgmData(1,1.17187500,1.0842339587421338776611125560463457086075505788857868002056510517927497),
            new AgmData(1,1.17968750,1.0879881844119991822237007798684516530828587007503748410299250975157120),
            new AgmData(1,1.18750000,1.0917364403632460910636367447904265327838142126236259158511494206205189),
            new AgmData(1,1.19531250,1.0954787841869424839411867648295189647219106339071500685283696557634395),
            new AgmData(1,1.20312500,1.0992152724999676136690421433379315661175919899530940880487366462316903),
            new AgmData(1,1.21093750,1.1029459609681734984195427722648030919552323091130524601131422094775537),
            new AgmData(1,1.21875000,1.1066709043288444233527427500952867299443919028795163436232074925775949),
            new AgmData(1,1.22656250,1.1103901564124802460926805044669654767759124703994537139986912367160666),
            new AgmData(1,1.23437500,1.1141037701639281019532334167900248918277835534571756468666840601978344),
            new AgmData(1,1.24218750,1.1178117976628860597967892187346061655752827914664635879360233509533631),
            new AgmData(1,1.25000000,1.1215142901438012850639010964145332702544865712033049879594118506937024),
            new AgmData(1,1.25781250,1.1252112980151843200832554105795397859805965112008494951305865008099395),
            new AgmData(1,1.26562500,1.1289028708783601906678966242567756341259105786509873954454583254266202),
            new AgmData(1,1.27343750,1.1325890575456761897900680714475521471919093200541058915450494866212924),
            new AgmData(1,1.28125000,1.1362699060581853715125254456595237954988555414203558153701109060445328),
            new AgmData(1,1.28906250,1.1399454637028240091835377138612356622793767461901733865447887587973192),
            new AgmData(1,1.29687500,1.1436157770291005291474904418880776232121691443719986902112213271629347),
            new AgmData(1,1.30468750,1.1472808918653127229730760234871609379791479246027912311326226326303147),
            new AgmData(1,1.31250000,1.1509408533343093656574725845972331436249646050479419632925695600791436),
            new AgmData(1,1.32031250,1.1545957058688117227325449009491234782115836805921609326489854210097802),
            new AgmData(1,1.32812500,1.1582454932263098140801258476344271909295199043993556797571402747694222),
            new AgmData(1,1.33593750,1.1618902585035477150512248695881505480613550950356768114069681635568123),
            new AgmData(1,1.34375000,1.1655300441506116147574154211245021242051713235963819375422762224011930),
            new AgmData(1,1.35156250,1.1691648919846338158206999272200470872412985014653655310820132141686294),
            new AgmData(1,1.35937500,1.1727948432031253481650739379035903501579995728629177301045666401708128),
            new AgmData(1,1.36718750,1.1764199383969493804136337356817322874898934004172060410712531400221435),
            new AgmData(1,1.37500000,1.1800402175629471449904890992398338872957148358728445029893000427204969),
            new AgmData(1,1.38281250,1.1836557201162276460502945731888381880006234062188479607980717593524786),
            new AgmData(1,1.39062500,1.1872664849021319918617194302308074226463502087411892430587436696108321),
            new AgmData(1,1.39843750,1.1908725502078827843014260065227586445996011002308368477810725893480019),
            new AgmData(1,1.40625000,1.1944739537739286067705866802855941580637939228870671445122105282540249),
            new AgmData(1,1.41406250,1.1980707328049932772737187989489249907831985212343449037096608726389898),
            new AgmData(1,1.42187500,1.2016629239808391747924670420448751392492624803544648931613732035873595),
            new AgmData(1,1.42968750,1.2052505634667536036807731721408987915370706098642074052414517865977715),
            new AgmData(1,1.43750000,1.2088336869237668318790323784028232416232303473123083092108805312103746),
            new AgmData(1,1.44531250,1.2124123295186101236079042534678912189545725923984292671987467269154043),
            new AgmData(1,1.45312500,1.2159865259334217852079498955671523952201740694264886880746701675037049),
            new AgmData(1,1.46093750,1.2195563103752089533236247522357105327358997183552175076560937741811119),
            new AgmData(1,1.46875000,1.2231217165850725771057449215006588220032411541322542582868605007444697),
            new AgmData(1,1.47656250,1.2266827778472027799718741527233215586550166193844815936895752234977526),
            new AgmData(1,1.48437500,1.2302395269976515311940908322242312134123120739527884999273026409026741),
            new AgmData(1,1.49218750,1.2337919964328893126800580778182867261593830436112262836596140604537394),
            new AgmData(1,1.50000000,1.2373402181181522313033298017957007446258370470333679334130913703152429),
            new AgmData(1,1.50781250,1.2408842235955858015733883828637293451566810579003298403512346189703494),
            new AgmData(1,1.51562500,1.2444240439921914068886194119694131928720877184420654214942311967140353),
            new AgmData(1,1.52343750,1.2479597100275812396812204641371079605565736457236142582625019769700774),
            new AgmData(1,1.53125000,1.2514912520215473210570177791134167489794160900872283620137895258421576),
            new AgmData(1,1.53906250,1.2550186999014500086894985137990804894549761662065693365991342290268570),
            new AgmData(1,1.54687500,1.2585420832094312173982597734370613323735014902909458201433634241710448),
            new AgmData(1,1.55468750,1.2620614311094573996967884657311028337851727696339755192425700221721791),
            new AgmData(1,1.56250000,1.2655767723941971633184167223941042322664039778902557548157259280350204),
            new AgmData(1,1.57031250,1.2690881354917382390231199118079476830261251505821958745467848634633229),
            new AgmData(1,1.57812500,1.2725955484721483545666733808259766959927048116284543056253673701345170),
            new AgmData(1,1.58593750,1.2760990390538844193063903335154650795232328903655399384017911296223660),
            new AgmData(1,1.59375000,1.2795986346100542782660297684145346185333994859119487294733962628657773),
            new AgmData(1,1.60156250,1.2830943621745351543405851462998307529868953568489866860838476696132367),
            new AgmData(1,1.60937500,1.2865862484479527624552863450945134640760628304403531658102075455943151),
            new AgmData(1,1.61718750,1.2900743198035249496790587504595504782238693638368446115404507693984975),
            new AgmData(1,1.62500000,1.2935586022927735903181463815592776033263800333220828624068319292856001),
            new AgmData(1,1.63281250,1.2970391216511083446778170379224584342945861620099342793684061852872396),
            new AgmData(1,1.64062500,1.3005159033032857742856478123366218207242354081789532015226484106284708),
            new AgmData(1,1.64843750,1.3039889723687471947344045444681856969310569124552926048489609081421836),
            new AgmData(1,1.65625000,1.3074583536668385397500349073651345523032541445173151963101857396277696),
            new AgmData(1,1.66406250,1.3109240717219154064529093783336989022202465871491384662802542404153780),
            new AgmData(1,1.67187500,1.3143861507683363518979411230861010876523021921455614122024604067651197),
            new AgmData(1,1.67968750,1.3178446147553474146986416685995838715012699177803411393221590552519924),
            new AgmData(1,1.68750000,1.3212994873518607427154817931213533742437613778225165449869033714589468),
            new AgmData(1,1.69531250,1.3247507919511301182806520882972374160243883366542703818197221597322974),
            new AgmData(1,1.70312500,1.3281985516753260861062248720703531110072565746560492790015965421840489),
            new AgmData(1,1.71093750,1.3316427893800133057535154648882856081164381194247350677927129497915313),
            new AgmData(1,1.71875000,1.3350835276585326702064800184153771596791541174477618184943557926241821),
            new AgmData(1,1.72656250,1.3385207888462906545749947375353031425439281288828803725852194273616745),
            new AgmData(1,1.73437500,1.3419545950249582841436746372155629338661381735874197487531901492587054),
            new AgmData(1,1.74218750,1.3453849680265820387722110137720512799906767184777768222733893280975096),
            new AgmData(1,1.75000000,1.3488119294376089409423689056642301697984584569165044123352508978034121),
            new AgmData(1,1.75781250,1.3522355006028280074375320567876378648621175180369594702800885617144794),
            new AgmData(1,1.76562500,1.3556557026292301796399561792888579654818064869219642910321650006626496),
            new AgmData(1,1.77343750,1.3590725563897887846496352975230318383382628511960004561490672824376292),
            new AgmData(1,1.78125000,1.3624860825271625187816562427131084935944815854112395767308830294498165),
            new AgmData(1,1.78906250,1.3658963014573228864045014037513764464207865889641937031017701120257073),
            new AgmData(1,1.79687500,1.3693032333731079704618109604119964167140263278171836670664348254336235),
            new AgmData(1,1.80468750,1.3727068982477043562997859625753988569314807369305200201044885425100591),
            new AgmData(1,1.81250000,1.3761073158380589775300041768941486714982618674112005265560229875556587),
            new AgmData(1,1.82031250,1.3795045056882226015242360830051970762404536434265131471065248470094095),
            new AgmData(1,1.82812500,1.3828984871326266226980582382090658387357851367117490863810338543118928),
            new AgmData(1,1.83593750,1.3862892792992947839305687292765232121981664876664045221501679483069988),
            new AgmData(1,1.84375000,1.3896769011129914002278270519121817080948909028656727643716097942020496),
            new AgmData(1,1.85156250,1.3930613712983076140097716774509459613210917823062354138329974984087195),
            new AgmData(1,1.85937500,1.3964427083826871681286940698511248657586111968799051967941076627020225),
            new AgmData(1,1.86718750,1.3998209306993931408585203403126718620214828102132288820511633462273988),
            new AgmData(1,1.87500000,1.4031960563904170465769926400917490511454416828758703518100572436747831),
            new AgmData(1,1.88281250,1.4065681034093316666482457453703415819786071768316771595278345492731188),
            new AgmData(1,1.89062500,1.4099370895240889370541142725662680306956380725360420528053624150015907),
            new AgmData(1,1.89843750,1.4133030323197641825735493259701433340238648570915026699700186257553210),
            new AgmData(1,1.90625000,1.4166659492012479517273459687363232858133934951519063473983697155597547),
            new AgmData(1,1.91406250,1.4200258573958866722482902169082734480396788308680881976645924856073119),
            new AgmData(1,1.92187500,1.4233827739560733134647857718062940435931469468827798590488200056098731),
            new AgmData(1,1.92968750,1.4267367157617892096605578581530984110535044982912465678333009105745722),
            new AgmData(1,1.93750000,1.4300876995230981671572090600129294855625286672969188641697565743956468),
            new AgmData(1,1.94531250,1.4334357417825939475247225935227666528253667565147002542462023444490810),
            new AgmData(1,1.95312500,1.4367808589178021899233602698878975107797817649246633573143402365232003),
            new AgmData(1,1.96093750,1.4401230671435378070859999276842619773337166690985208705217742608169649),
            new AgmData(1,1.96875000,1.4434623825142188618312843658840780885553405078379565498802567512386121),
            new AgmData(1,1.97656250,1.4467988209261379042247103824051264199065701777204352958738290142407775),
            new AgmData(1,1.98437500,1.4501323981196917235478360961683228225043695257391100170127863449724962),
            new AgmData(1,1.99218750,1.4534631296815704440671059478981482651756074584704148253394126835500976),

            // 0.5 ... 1

            new AgmData(1,0.503906250,0.73075681100354930075957747126599766618836128283358901654895910704935072),
            new AgmData(1,0.507812500,0.73311254692498791174688389899357743723490440167614180543472032835991764),
            new AgmData(1,0.511718750,0.73546279219426091617548003499678884684248755555308267616243055554287915),
            new AgmData(1,0.515625000,0.73780761430212906454021721381733542864749013395698581053733659512872489),
            new AgmData(1,0.519531250,0.74014707936338362283490553921955866845510454786799657235297102318436547),
            new AgmData(1,0.523437500,0.74248125215520132847246680176572792163219074793432948347443672630349646),
            new AgmData(1,0.527343750,0.74481019615415270010749138658116979720054369481117214805814369261203929),
            new AgmData(1,0.531250000,0.74713397357192054750019408236644472837960490779637011153084840370867674),
            new AgmData(1,0.535156250,0.74945264538978272976069536039073860777628504494096060361307167756960823),
            new AgmData(1,0.539062500,0.75176627139191056954896072930683523866784693924763251397708034545854036),
            new AgmData(1,0.542968750,0.75407491019753183719352024954276140771745586543049868299101536960912340),
            new AgmData(1,0.546875000,0.75637861929200486303490667215967502858449599856869208123000977396194421),
            new AgmData(1,0.550781250,0.75867745505684811003741617418869185971774085908158987181827889634328584),
            new AgmData(1,0.554687500,0.76097147279876743387310981717822084666723117208745165917673304334044405),
            new AgmData(1,0.558593750,0.76326072677772126683647737065330512917176051324865090929510329029576295),
            new AgmData(1,0.562500000,0.76554527023406207817153753676773222637786769757873273443654118797441641),
            new AgmData(1,0.566406250,0.76782515541479068022580132521522065395629024360362914944366752410048971),
            new AgmData(1,0.570312500,0.77010043359895826125940212137460734077247953491226429038363036344554963),
            new AgmData(1,0.574218750,0.77237115512224942610461945006516121832032207031621177544995736234500258),
            new AgmData(1,0.578125000,0.77463736940077800993365066406144308523431885102584052671959851941689290),
            new AgmData(1,0.582031250,0.77689912495412599323753729843767304751773424209098690261248792957287810),
            new AgmData(1,0.585937500,0.77915646942765448315274540603290184030140908179409257125642560234843173),
            new AgmData(1,0.589843750,0.78140944961411443319679020139589582596521659720235233240004027305828699),
            new AgmData(1,0.593750000,0.78365811147458354626889722592811020099286769026072405114420786122286323),
            new AgmData(1,0.597656250,0.78590250015875464067069523586151597036005736322592518583831386066055195),
            new AgmData(1,0.601562500,0.78814266002459965237841142200305793088617031078069641704973147936783460),
            new AgmData(1,0.605468750,0.79037863465743239554690080001245036265496183184357714840316718855426357),
            new AgmData(1,0.609375000,0.79261046688839220414855178983703855591329586894705269502749247738941827),
            new AgmData(1,0.613281250,0.79483819881236962784053490278423275082077779371991103670646664783565905),
            new AgmData(1,0.617187500,0.79706187180539445188517517847463916591642784113889193041233377374626147),
            new AgmData(1,0.621093750,0.79928152654150545166078796069721760567464051960818552045228000325064817),
            new AgmData(1,0.625000000,0.80149720300912047459042546494531525118798929470235764333832444709498436),
            new AgmData(1,0.628906250,0.80370894052692466392547477036044973037885347459198092237008121147471987),
            new AgmData(1,0.632812500,0.80591677775929389762763666460371935300325847807303242688492268278237500),
            new AgmData(1,0.636718750,0.80812075273126980960112119379337631304928152655975834746535624024769076),
            new AgmData(1,0.640625000,0.81032090284310208786013377212847559195321838439463785101176140014698028),
            new AgmData(1,0.644531250,0.81251726488437310310897413871443432120861026173427485462403518229113665),
            new AgmData(1,0.648437500,0.81470987504771931000109319996140139750970017760777465588556005402231799),
            new AgmData(1,0.652343750,0.81689876894216328046402429216795249568422014422354453865777180226510438),
            new AgmData(1,0.656250000,0.81908398160606967245480309953178681178534406998923614979502512918018003),
            new AgmData(1,0.660156250,0.82126554751973790695591908300170219669585537609710332476581421349433426),
            new AgmData(1,0.664062500,0.82344350061764381962525634314808263545850790048657270683250501286230255),
            new AgmData(1,0.667968750,0.82561787430034207003978279236778979311418615900618784861437645109108826),
            new AgmData(1,0.671875000,0.82778870144604062975681191950392893554492407531578274078383764602401864),
            new AgmData(1,0.675781250,0.82995601442185822935900112578006399549424625555876113039829183659026678),
            new AgmData(1,0.679687500,0.83211984509477522321195148254881275691618137786624019629215342680777687),
            new AgmData(1,0.683593750,0.83428022484228792786621780666264228689156653850753233361405434708573103),
            new AgmData(1,0.687500000,0.83643718456277610495287285916094282013967015891253996263668220025703221),
            new AgmData(1,0.691406250,0.83859075468559289117861354296976253692276897968101240903282848392531790),
            new AgmData(1,0.695312500,0.84074096518088612579576155429261313973288032664701389538523048736786579),
            new AgmData(1,0.699218750,0.84288784556915968892242491686720731553982624202368599635701554764276747),
            new AgmData(1,0.703125000,0.84503142493058314157890882617742155645607731261940560931214120684457045),
            new AgmData(1,0.707031250,0.84717173191405764958836931630173985787744777050175525182793908249113210),
            new AgmData(1,0.710937500,0.84930879474604587790033189417163353020434545624315527208039562372219704),
            new AgmData(1,0.714843750,0.85144264123917325880795523067423921506803644576614882987815564946634598),
            new AgmData(1,0.718750000,0.85357329880060776634991873255853577771675995456761751915006777957030388),
            new AgmData(1,0.722656250,0.85570079444022506935294074221360624585522223382879661477435533939066670),
            new AgmData(1,0.726562500,0.85782515477856568654804959190714260793578317640123781208033045790178668),
            new AgmData(1,0.730468750,0.85994640605459052847746768815487957698826403661404972296308462509186438),
            new AgmData(1,0.734375000,0.86206457413324098202015308283702580255383840607338429334200345362695313),
            new AgmData(1,0.738281250,0.86417968451280947384819750291716148400341611044515639665978708925612494),
            new AgmData(1,0.742187500,0.86629176233212623855223165739692019298004515060118372071096191727599919),
            new AgmData(1,0.746093750,0.86840083237756781513255718244525980365098053801097051772410232579839531),
            new AgmData(1,0.750000000,0.87050691908989260165549073728917150134813635904018285570747161451482098),
            new AgmData(1,0.753906250,0.87261004657090861175255618288814536575549946483827956321379677683112640),
            new AgmData(1,0.757812500,0.87471023858997839794340204854906429516386456606170577438085768463717185),
            new AgmData(1,0.761718750,0.87680751859036593515885972632559042454297882072226519143796119892390061),
            new AgmData(1,0.765625000,0.87890190969543009301213940995333564010076810217310353579780051306518511),
            new AgmData(1,0.769531250,0.88099343471466916701317031678583342936132728552603926726320283361000726),
            new AgmData(1,0.773437500,0.88308211614962078675770348635702102976461905001692996461384384116034696),
            new AgmData(1,0.777343750,0.88516797619962137287717496300462989417237606480656710609283294633213268),
            new AgmData(1,0.781250000,0.88725103676742917394887964820702028690496114387448843320206429336530535),
            new AgmData(1,0.785156250,0.88933131946471477939266880031310611046850286813123784286546299739009704),
            new AgmData(1,0.789062500,0.89140884561742287438595986846405047961630616534959526509522847727095261),
            new AgmData(1,0.792968750,0.89348363627100887779037650417072814215461693338706225152365996724105673),
            new AgmData(1,0.796875000,0.89555571219555398378850548225583084306793779602358287497718777747682834),
            new AgmData(1,0.800781250,0.89762509389076201217584015157332678115091682677716313746745408723466850),
            new AgmData(1,0.804687500,0.89969180159084136084831311675685036567444206262352177171121437746707082),
            new AgmData(1,0.808593750,0.90175585526927524678630602553855312573230035671175702993223954908229658),
            new AgmData(1,0.812500000,0.90381727464348331858666101532046094507637099116132933724995369808634192),
            new AgmData(1,0.816406250,0.90587607917937762416816159826135162268900092169760124627668611355919557),
            new AgmData(1,0.820312500,0.90793228809581582151409403067802100707749040029748666246581898145778788),
            new AgmData(1,0.824218750,0.90998592036895442806608151488976531036808190995045832950036109604429857),
            new AgmData(1,0.828125000,0.91203699473650481550161328486101961418490168133633201261518833402729932),
            new AgmData(1,0.832031250,0.91408552970189457097539985395718461617719490573224485831914502103816033),
            new AgmData(1,0.835937500,0.91613154353833676334999401731353915994143159385317931667405191383885486),
            new AgmData(1,0.839843750,0.91817505429280957335811844129556663788313598578635283793844238245168173),
            new AgmData(1,0.843750000,0.92021607978994866990760586676065150742341017349897184976136291745900692),
            new AgmData(1,0.847656250,0.92225463763585464074495431161306319534557096568964616132734274586351783),
            new AgmData(1,0.851562500,0.92429074522181771432552470271104767694575749882965239034473980766973879),
            new AgmData(1,0.855468750,0.92632441972796194089253831499288229742738299111437657781975748091857552),
            new AgmData(1,0.859375000,0.92835567812681093434308297596917976442087504419983954044152934970948930),
            new AgmData(1,0.863281250,0.93038453718677721236154191877560287512857955753241661351675271679674813),
            new AgmData(1,0.867187500,0.93241101347557711043765053260264400989941723526617077341568452897272475),
            new AgmData(1,0.871093750,0.93443512336357318567019619268158902809265068379418331715023189457814939),
            new AgmData(1,0.875000000,0.93645688302704596860444426692169186772994743146396734242171188033995601),
            new AgmData(1,0.878906250,0.93847630845139686568156425513930175330242922000278150550168096144381723),
            new AgmData(1,0.882812500,0.94049341543428396111496203478204585828388615051486928481330847599860947),
            new AgmData(1,0.886718750,0.94250821958869241507810544859582864700452510526282790303220818882581378),
            new AgmData(1,0.890625000,0.94452073634594110492090395909228065969833351240406248973915297270168100),
            new AgmData(1,0.894531250,0.94653098095862710765969967241107168328107799802645293722794960302696447),
            new AgmData(1,0.898437500,0.94853896850350957514502591879920340102257688828906341079423436105684925),
            new AgmData(1,0.902343750,0.95054471388433450803978591853787531387079588444006545398035549193285342),
            new AgmData(1,0.906250000,0.95254823183460189097928321774754083036399958691451994614468720288783683),
            new AgmData(1,0.910156250,0.95454953692027660897695372284357610580805594521818996348181062646166492),
            new AgmData(1,0.914062500,0.95654864354244452423141988921444912036460637784661426425847959679537152),
            new AgmData(1,0.917968750,0.95854556593991505292957420843149387149641071404397143024254015618587389),
            new AgmData(1,0.921875000,0.96054031819177154337691218067405077871978933759393970328045626380148830),
            new AgmData(1,0.925781250,0.96253291421987071977243505692390598045462218154053748731059559444372688),
            new AgmData(1,0.929687500,0.96452336779129242013524789875677085007473386157245704854940149695403726),
            new AgmData(1,0.933593750,0.96651169252074082223947659212395582564055669441805965807259806295098897),
            new AgmData(1,0.937500000,0.96849790187289831788109191995173592870219485556666735543908854938329736),
            new AgmData(1,0.941406250,0.97048200916473316334413951594608658005001768201878370777711379535161886),
            new AgmData(1,0.945312500,0.97246402756776200251584195330583871569561179355490766416842091164274152),
            new AgmData(1,0.949218750,0.97444397011026832868273236607389371316974470875738390578231120055828848),
            new AgmData(1,0.953125000,0.97642184967947792158755679705428364299913705689536725428733144338526130),
            new AgmData(1,0.957031250,0.97839767902369226780472848763710924468676783927225203339219690227018954),
            new AgmData(1,0.960937500,0.98037147075438094486757758786810243345137523452131507486357448080107606),
            new AgmData(1,0.964843750,0.98234323734823392282176349497661312184097734717740021195326459938558981),
            new AgmData(1,0.968750000,0.98431299114917471095550022921050575244099297178932115619585269782040747),
            new AgmData(1,0.972656250,0.98628074437033525233937693983987329874214791312862490964011822576328976),
            new AgmData(1,0.976562500,0.98824650909599344446836657806533823129731815431577153166386433820642381),
            new AgmData(1,0.980468750,0.99021029728347414070902966953074120430757187038405837926183487034760846),
            new AgmData(1,0.984375000,0.99217212076501446438990700265216579477216149171844007740745174308951173),
            new AgmData(1,0.988281250,0.99413199124959424520762688719723897047928767157152885807163488960872740),
            new AgmData(1,0.992187500,0.99608992032473236613126097041991094619913440748828495509901816499592253),
            new AgmData(1,0.996093750,0.99804591945824978814979812941068269531584063887481259895711089635423514),

                                                   };


#endregion

        static IEnumerable<TestCase<double, double>> GetAgmData(AgmData[] data)
        {
            return data.Select(d => TestCase.Create(d.A, d.B, d.Result));
        }


        [TestMethod]
        public void AgmTest()
        {

            TestCaseSet<double, double>[] testCases = {
                new TestCaseSet<double, double>(GetAgmData(_Agm_Spot), "Agm spot values", 2),
                new TestCaseSet<double, double>(GetAgmData(_Agm_A1_BNear1), "Agm(1, [0.75...1.25]", 2),
                new TestCaseSet<double, double>(GetAgmData(_Agm_A1_Bgt2), "Agm(1, 1.5 ... 30", 2),
                new TestCaseSet<double, double>(GetAgmData(_Agm_A1_PowersOfMinus2B), "Agm(1, 2^-[1...960]", 2),
            };

            NumericFunctionTest.RunSet(Math2.Agm, "Agm", testCases);

        }
    }
}
