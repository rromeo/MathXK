//  Copyright (c) 2013 Rocco Romeo
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

//  Test cases ported from Boost:
//      Copyright (c) John Maddock 2006, Boost Software License v1.0


using System;
using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace MathXK.Test.Functions
{

    using TestCase1 = TestCase<double>;


    /// <summary>
    ///This is a test class for Math2Test and is intended
    ///to contain all Math2Test Unit Tests
    ///</summary>
    [TestClass()]
    public class T_Gamma
    {


        private TestContext testContextInstance;

        /// <summary>
        ///Gets or sets the test context which provides
        ///information about and functionality for the current test run.
        ///</summary>
        public TestContext TestContext
        {
            get
            {
                return testContextInstance;
            }
            set
            {
                testContextInstance = value;
            }
        }

        #region Additional test attributes
        // 
        //You can use the following additional attributes as you write your tests:
        //
        //Use ClassInitialize to run code before running the first test in the class
        //[ClassInitialize()]
        //public static void MyClassInitialize(TestContext testContext)
        //{
        //}
        //
        //Use ClassCleanup to run code after all tests in a class have run
        //[ClassCleanup()]
        //public static void MyClassCleanup()
        //{
        //}
        //
        //Use TestInitialize to run code before running each test
        //[TestInitialize()]
        //public void MyTestInitialize()
        //{
        //}
        //
        //Use TestCleanup to run code after each test has run
        //[TestCleanup()]
        //public void MyTestCleanup()
        //{
        //}
        //
        #endregion

        struct GammaData
        {
            public readonly double X;
            public readonly double Tgamma;
            public readonly double Lgamma;

            public GammaData(double x, double tgamma, double lgamma)
            {
                X = x;
                Tgamma = tgamma;
                Lgamma = lgamma;
            }
        }

        #region Test Case Data



        private static readonly GammaData[] _Factorials = {
            new GammaData(1, 1, 0),
            new GammaData(2, 1, 0),
            new GammaData(3, 2, 0.6931471805599453094172321214581765680755),
            new GammaData(4, 6, 1.791759469228055000812477358380702272723),
            new GammaData(5, 24, 3.178053830347945619646941601297055408874),
            new GammaData(6, 120, 4.7874917427820459942477009345232430484),
            new GammaData(7, 720, 6.579251212010100995060178292903945321123),
            new GammaData(8, 5040, 8.52516136106541430016553103634712505076),
            new GammaData(9, 40320, 10.60460290274525022841722740072165475499),
            new GammaData(10, 362880, 12.80182748008146961120771787456670616428),
            new GammaData(11, 3628800, 15.10441257307551529522570932925107037188),
            new GammaData(12, 39916800, 17.5023078458738858392876529072161996717),
            new GammaData(13, 479001600, 19.9872144956618861495173623870550785125),
            new GammaData(14, 6227020800.0, 22.55216385312342288557084982862039711731),
            new GammaData(15, 87178291200.0, 25.19122118273868150009343469352175341502),
            new GammaData(16, 1307674368000.0, 27.89927138384089156608943926367046675919),
            new GammaData(17, 20922789888000.0, 30.6718601060806728037583677495031730315),
            new GammaData(18, 355687428096000.0, 33.50507345013688888400790236737629956708),
            new GammaData(19, 6402373705728000.0, 36.39544520803305357621562496267952754445),
            new GammaData(20, 121645100408832000.0, 39.33988418719949403622465239456738108169),
            new GammaData(21, 0.243290200817664e19, 42.33561646075348502965987597070992185737),
            new GammaData(22, 0.5109094217170944e20, 45.38013889847690802616047395107562729165),
            new GammaData(23, 0.112400072777760768e22, 48.47118135183522387963964965049893315955),
            new GammaData(24, 0.2585201673888497664e23, 51.60667556776437357044640248230912927799),
            new GammaData(25, 0.62044840173323943936e24, 54.78472939811231919009334408360618468687),
            new GammaData(26, 0.15511210043330985984e26, 58.00360522298051993929486275005855996592),
            new GammaData(27, 0.403291461126605635584e27, 61.2617017610020019847655823130820551388),
            new GammaData(28, 0.10888869450418352160768e29, 64.55753862700633105895131802384963225274),
            new GammaData(29, 0.304888344611713860501504e30, 67.88974313718153498289113501020916511853),
            new GammaData(30, 0.8841761993739701954543616e31, 71.25703896716800901007440704257107672402),
            new GammaData(31, 0.26525285981219105863630848e33, 74.65823634883016438548764373417796663627),
            new GammaData(32, 0.822283865417792281772556288e34, 78.09222355331531063141680805872032384672),
            new GammaData(33, 0.26313083693369353016721801216e36, 81.5579594561150371785029686660112066871),
            new GammaData(34, 0.868331761881188649551819440128e37, 85.05446701758151741396015748089886169157),
            new GammaData(35, 0.29523279903960414084761860964352e39, 88.58082754219767880362692422023016479523),
            new GammaData(36, 0.103331479663861449296666513375232e41, 92.13617560368709248333303629689953216439),
            new GammaData(37, 0.3719933267899012174679994481508352e42, 95.71969454214320248495799101366093670984),
            new GammaData(38, 0.137637530912263450463159795815809024e44, 99.33061245478742692932608668469238387374),
            new GammaData(39, 0.5230226174666011117600072241000742912e45, 102.9681986145138126987523462380384139791),
            new GammaData(40, 0.203978820811974433586402817399028973568e47, 106.6317602606434591262010789165262582885),
            new GammaData(41, 0.815915283247897734345611269596115894272e48, 110.3206397147573954290535346141269756323),
            new GammaData(42, 0.3345252661316380710817006205344075166515e50, 114.0342117814617032329202979871643832206),
            new GammaData(43, 0.1405006117752879898543142606244511569936e52, 117.771881399745071538838128088988265223),
            new GammaData(44, 0.6041526306337383563735513206851399750726e53, 121.5330815154386339623109706023341122586),
            new GammaData(45, 0.265827157478844876804362581101461589032e55, 125.3172711493568951252073784232155946945),
            new GammaData(46, 0.1196222208654801945619631614956577150644e57, 129.1239336391272148825986282302868337433),
            new GammaData(47, 0.5502622159812088949850305428800254892962e58, 132.9525750356163098828226131835552064299),
            new GammaData(48, 0.2586232415111681806429643551536119799692e60, 136.8027226373263684696435638533273801388),
            new GammaData(49, 0.1241391559253607267086228904737337503852e62, 140.6739236482342593987077375760826121157),
            new GammaData(50, 0.6082818640342675608722521633212953768876e63, 144.565743946344886008918443062968971575),
            new GammaData(51, 0.3041409320171337804361260816606476884438e65, 148.4777669517730320675371938508795234221),
            new GammaData(52, 0.1551118753287382280224243016469303211063e67, 152.4095925844973578391819737056751756623),
            new GammaData(53, 0.8065817517094387857166063685640376697529e68, 156.3608363030787851940699253901568474033),
            new GammaData(54, 0.427488328406002556429801375338939964969e70, 160.3311282166309070282143945291859051737),
            new GammaData(55, 0.2308436973392413804720927426830275810833e72, 164.3201122631951814118173623614116588557),
            new GammaData(56, 0.1269640335365827592596510084756651695958e74, 168.327445448427652330480065272602975795),
            new GammaData(57, 0.7109985878048634518540456474637249497365e75, 172.3527971391628015638371143804206852289),
            new GammaData(58, 0.4052691950487721675568060190543232213498e77, 176.3958484069973517152413870492310644708),
            new GammaData(59, 0.2350561331282878571829474910515074683829e79, 180.4562914175437710518418912030511526443),
            new GammaData(60, 0.1386831185456898357379390197203894063459e81, 184.5338288614494905024579415767708502684),
            new GammaData(61, 0.8320987112741390144276341183223364380754e82, 188.6281734236715911872884103898359167487),
            new GammaData(62, 0.507580213877224798800856812176625227226e84, 192.7390472878449024360397994932615314951),
            new GammaData(63, 0.3146997326038793752565312235495076408801e86, 196.8661816728899939913861959392620652736),
            new GammaData(64, 0.1982608315404440064116146708361898137545e88, 201.0093163992815266792820391565502964125),
            new GammaData(65, 0.1268869321858841641034333893351614808029e90, 205.168199482641198535785431885299355821),
            new GammaData(66, 0.8247650592082470666723170306785496252186e91, 209.3425867525368356464396786600908620653),
            new GammaData(67, 0.5443449390774430640037292402478427526443e93, 213.5322414945632611913140995964366936378),
            new GammaData(68, 0.3647111091818868528824985909660546442717e95, 217.7369341139542272509841715928004163884),
            new GammaData(69, 0.2480035542436830599600990418569171581047e97, 221.9564418191303339500681704535898960601),
            new GammaData(70, 0.1711224524281413113724683388812728390923e99, 226.1905483237275933322701685223226178832),
            new GammaData(71, 0.1197857166996989179607278372168909873646e101, 230.4390435657769523213935127204501618205),
            new GammaData(72, 0.8504785885678623175211676442399260102886e102, 234.7017234428182677427229672529631959172),
            new GammaData(73, 0.6123445837688608686152407038527467274078e104, 238.9783895618343230537651540911827770308),
            new GammaData(74, 0.4470115461512684340891257138125051110077e106, 243.2688490029827141828572629486213196017),
            new GammaData(75, 0.3307885441519386412259530282212537821457e108, 247.5729140961868839366425907411109433336),
            new GammaData(76, 0.2480914081139539809194647711659403366093e110, 251.8904022097231943772393546444858443173),
            new GammaData(77, 0.188549470166605025498793226086114655823e112, 256.2211355500095254560828463192900509907),
            new GammaData(78, 0.1451830920282858696340707840863082849837e114, 260.5649409718632093052501426406983600202),
            new GammaData(79, 0.1132428117820629783145752115873204622873e116, 264.9216497985528010421161074406443808977),
            new GammaData(80, 0.8946182130782975286851441715398316520698e117, 269.2910976510198225362890529821257918199),
            new GammaData(81, 0.7156945704626380229481153372318653216558e119, 273.6731242856937041485587408011846857317),
            new GammaData(82, 0.5797126020747367985879734231578109105412e121, 278.0675734403661429141397217488747885503),
            new GammaData(83, 0.4753643337012841748421382069894049466438e123, 282.4742926876303960274237172433703727067),
            new GammaData(84, 0.3945523969720658651189747118012061057144e125, 286.8931332954269939508991894666617431598),
            new GammaData(85, 0.3314240134565353266999387579130131288001e127, 291.3239500942703075662342516899438017302),
            new GammaData(86, 0.2817104114380550276949479442260611594801e129, 295.7666013507606240210845456410431159053),
            new GammaData(87, 0.2422709538367273238176552320344125971528e131, 300.220948647014131753974620275847139509),
            new GammaData(88, 0.210775729837952771721360051869938959523e133, 304.6868567656687154725531375451315768191),
            new GammaData(89, 0.1854826422573984391147968456455462843802e135, 309.1641935801469219448667774874712358232),
            new GammaData(90, 0.1650795516090846108121691926245361930984e137, 313.6528299498790617831845930281410850426),
            new GammaData(91, 0.1485715964481761497309522733620825737886e139, 318.1526396202093268499930749566705006595),
            new GammaData(92, 0.1352001527678402962551665687594951421476e141, 322.6634991267261768911519151416789989939),
            new GammaData(93, 0.1243841405464130725547532432587355307758e143, 327.1852877037752172007931322164055482485),
            new GammaData(94, 0.1156772507081641574759205162306240436215e145, 331.7178871969284731381175417778704311636),
            new GammaData(95, 0.1087366156656743080273652852567866010042e147, 336.2611819791984770343557245691007814406),
            new GammaData(96, 0.103299784882390592625997020993947270954e149, 340.8150588707990178689655113342148226173),
            new GammaData(97, 0.9916779348709496892095714015418938011582e150, 345.3794070622668541074469171784282311623),
            new GammaData(98, 0.9619275968248211985332842594956369871234e152, 349.9541180407702369295636388001321928762),
            new GammaData(99, 0.942689044888324774562618574305724247381e154, 354.5390855194408088491915764084767289035),
            new GammaData(1.5, 0.8862269254527580136490837416705725913988, -0.1207822376352452223455184457816472122519),
            new GammaData(2.5, 1.329340388179137020473625612505858887098, 0.2846828704729191596324946696827019243201),
            new GammaData(3.5, 3.323350970447842551184064031264647217745, 1.20097360234707422481602188145071299577),
            new GammaData(4.5, 11.63172839656744892914422410942626526211, 2.453736570842442220504142503435716157332),
            new GammaData(5.5, 52.34277778455352018114900849241819367949, 3.957813967618716293877400855822590998551),
            new GammaData(6.5, 287.8852778150443609963195467083000652372, 5.662562059857141528522112312329543730298),
            new GammaData(7.5, 1871.254305797788346476077053603950424042, 7.534364236758732955158367632436685767027),
            new GammaData(8.5, 14034.40729348341259857057790202962818031, 9.549267257300997711737140081127222543125),
            new GammaData(9.5, 119292.4619946090070878499121672518395327, 11.68933342079726848256944257754217251064),
            new GammaData(10.5, 1133278.38894878556733457416558889247556, 13.9406252194037636331612378879718494798),
            new GammaData(11.5, 11899423.08396224845701302873868337099338, 16.29200047656724132024460374687937834601),
            new GammaData(12.5, 136843365.4655658572556498304948587664239, 18.73434751193644570163412445723139789638),
            new GammaData(13.5, 1710542068.319573215695622881185734580299, 21.26007615624470114141841100222559660735),
            new GammaData(14.5, 23092317922.31423841189090889600741683403, 23.86276584168908490618691459153499715322),
            new GammaData(15.5, 334838609873.5564569724181789921075440935, 26.53691449111561362395295450243873219064),
            new GammaData(16.5, 5189998453040.125083072481774377666933449, 29.27775451504081456046488670552291283301),
            new GammaData(17.5, 85634974475162.06387069594927723150440191, 32.08111489594734948650484339895239126941),
            new GammaData(18.5, 1498612053315336.117737179112351551327033, 34.94331577687681785679372335416358207049),
            new GammaData(19.5, 27724322986333718.17813781357850369955012, 37.86108650896109699174458690373685266632),
            new GammaData(20.5, 540624298233507504.4736873647808221412273, 40.83150097453079810977608746076652040769),
            new GammaData(21.5, 11082798113786903841.71059097800685389516, 43.851925860675160604225618712345751428),
            new GammaData(22.5, 238280159446418432596.7777060271473587459, 46.91997879580877771828122910423342189548),
            new GammaData(23.5, 5361303587544414733427.498385610815571784, 50.03349410501915216625524678984648437622),
            new GammaData(24.5, 125990634307293746235546.2120618541659369, 53.19049452616926544365896533816048151704),
            new GammaData(25.5, 3086770540528696782770882.195515427065454, 56.38916764371994674445243870358866440824),
            new GammaData(26.5, 78712648783481767960657495.98564339016909, 59.6278460958843272066799864369261400804),
            new GammaData(27.5, 2085885192762266850957423643.619549839481, 62.90499082887650373140722345449702128269),
            new GammaData(28.5, 57361842800962338401329150199.53762058572, 66.21917683354902934065269424423016165396),
            new GammaData(29.5, 1634812519827426644437880780686.822186693, 69.56908092082363418263973479158236432777),
            new GammaData(30.5, 48226969334909086010917483030261.25450745, 72.95347118416940832383855304384388538376),
            new GammaData(31.5, 1470922564714727123332983232422968.262477, 76.371197867782774263172710025811323562),
            new GammaData(32.5, 46334060788513904384988971821323500.26803, 79.82118541361436164165132112164137813285),
            new GammaData(33.5, 1505856975626701892512141584193013758.711, 83.30242550295005344288833577497470780911),
            new GammaData(34.5, 50446208683494513399156743070465960916.82, 86.8139709417810741931411756498802539916),
            new GammaData(35.5, 1740394199580560712270907635931075651630.0, 90.35493026581838826592594159715479924661),
            new GammaData(36.5, 61783994085109905285617221075553185632870.0, 93.9244629622997583778381640082096567753),
            new GammaData(37.5, 0.22551157841065115429250285692576912756e43, 97.52177522288820419751304074419002277813),
            new GammaData(38.5, 0.8456684190399418285968857134716342283499e44, 101.1461161558645693286925725261067471938),
            new GammaData(39.5, 0.3255823413303776040098009996865791779147e46, 104.7967743971583078684426367260568796551),
            new GammaData(40.5, 0.1286050248254991535838713948761987752763e48, 108.4730750690653840531983501460801140092),
            new GammaData(41.5, 0.5208503505432715720146791492486050398691e49, 112.1743770431778775093620989723120402597),
            new GammaData(42.5, 0.2161528954754577023860918469381710915457e51, 115.9000704704145301234203390741452341447),
            new GammaData(43.5, 0.9186498057706952351408903494872271390691e52, 119.6495745463449012688534009037863717517),
            new GammaData(44.5, 0.3996126655102524272862873020269438054951e54, 123.4223354844395396780146860516126324938),
            new GammaData(45.5, 0.1778276361520623301423978494019899934453e56, 127.2178246736117342069152694708243051451),
            new GammaData(46.5, 0.8091157444918836021479102147790544701761e57, 131.0355369995686389386568775343746269115),
            new GammaData(47.5, 0.3762388211887258749987782498722603286319e59, 134.8749893121619495665640549743813332585),
            new GammaData(48.5, 0.1787134400646447906244196686893236561001e61, 138.7357190232025450917566096180371978672),
            new GammaData(49.5, 0.8667601843135272345284353931432197320857e62, 142.6172828211459826044560991182829830129),
            new GammaData(50.5, 0.4290462912351959810915755196058937673824e64, 146.519255490720627221891301048634987154),
            new GammaData(51.5, 0.2166683770737739704512456374009763525281e66, 150.4412288270019413633582671940897997428),
            new GammaData(52.5, 0.111584214192993594782391503261502821552e68, 154.3828106346716318247096373876850639954),
            new GammaData(53.5, 0.5858171245132163726075553921228898131479e69, 158.3436238042692098863937625798187805011),
            new GammaData(54.5, 0.3134121616145707593450421347857460500341e71, 162.3233054581711707502809292753838809346),
            new GammaData(55.5, 0.1708096280799410638430479634582315972686e73, 166.3215061598403691412410136061349060176),
            new GammaData(56.5, 0.9479934358436729043289161971931853648408e74, 170.337889180592757967587122392630702318),
            new GammaData(57.5, 0.535616291251675190945837651414149731135e76, 174.372129818745153226752021764788547422),
            new GammaData(58.5, 0.3079793674697132347938566495631360954026e78, 178.4239147665484579827423018083667546119),
            new GammaData(59.5, 0.1801679299697822423544061399944346158105e80, 182.4929415207862687921690476023189480579),
            new GammaData(60.5, 0.1071999183320204342008716532966885964073e82, 186.5789178333378528681067028421770777551),
            new GammaData(61.5, 0.648559505908723626915273502444966008264e83, 190.6815611983746486468133578766491597866),
            new GammaData(62.5, 0.3988640961338650305528932040036540950824e85, 194.8005983731871208326581343651509165116),
            new GammaData(63.5, 0.2492900600836656440955582525022838094265e87, 198.9357649299294766470431802433713028621),
            new GammaData(64.5, 0.1582991881531276840006794903389502189858e89, 203.0868048358281226106733889296294186889),
            new GammaData(65.5, 0.1021029763587673561804382712686228912459e91, 207.253470059629849416124244558439614861),
            new GammaData(66.5, 0.6687744951499261829818706768094799376603e92, 211.435520202271055650856436448150964186),
            new GammaData(67.5, 0.4447350392747009116829440000783041585441e94, 215.6327221499328641065535845020238208848),
            new GammaData(68.5, 0.3001961515104231153859872000528553070173e96, 219.8448497478113482459228474245594090702),
            new GammaData(69.5, 0.2056343637846398340394012320362058853068e98, 224.0716834930795278518208054310810978927),
            new GammaData(70.5, 0.1429158828303246846573838562651630902882e100, 228.3130102456502742995923582284984651071),
            new GammaData(71.5, 0.1007556973953789026834556186669399786532e102, 232.5686229554684972683913220137349879525),
            new GammaData(72.5, 0.7204032363769591541867076734686208473705e103, 236.8383204051684592390895209118072592891),
            new GammaData(73.5, 0.5222923463732953867853630632647501143436e105, 241.121906967029088331456320155937181966),
            new GammaData(74.5, 0.3838848745843721092872418514995913340426e107, 245.4191923732478793236450387582878905619),
            new GammaData(75.5, 0.2859942315653572214189951793671955438617e109, 249.7299914986333931552202349119338344817),
            new GammaData(76.5, 0.2159256448318447021713413604222326356156e111, 254.0541241548883721745992390899601342039),
            new GammaData(77.5, 0.1651831182963611971610761407230079662459e113, 258.3914148957208623282220320602201355807),
            new GammaData(78.5, 0.1280169166796799277998340090603311738406e115, 262.7416928320801636393347235965305038626),
            new GammaData(79.5, 0.1004932795935487433228696971123599714649e117, 267.1047914568685263873419367114758025432),
            new GammaData(80.5, 0.7989215727687125094168140920432617731457e118, 271.4805484785288126034644189659692094502),
            new GammaData(81.5, 0.6431318660788135700805353440948257273823e120, 275.8688056629533302899592924197644087302),
            new GammaData(82.5, 0.5241524708542330596156363054372829678165e122, 280.2694086832001473146069926644269820387),
            new GammaData(83.5, 0.4324257884547422741828999519857584484486e124, 284.6822069765407826152477086910826481146),
            new GammaData(84.5, 0.3610755333597097989427214599081083044546e126, 289.1070536083975924130902273463692509124),
            new GammaData(85.5, 0.3051088256889547801065996336223515172642e128, 293.5438051427607205757799701080417115539),
            new GammaData(86.5, 0.2608680459640563369911426867471105472609e130, 297.9923215187034351091622558923164399324),
            new GammaData(87.5, 0.2256508597589087314973384240362506233806e132, 302.4524659326412687466785241592992548335),
            new GammaData(88.5, 0.1974445022890451400601711210317192954581e134, 306.9241047260048374915681634477366332741),
            new GammaData(89.5, 0.1747383845258049489532514421130715764804e136, 311.4071072780187213241622269369206800347),
            new GammaData(90.5, 0.1563908541505954293131600406911990609499e138, 315.9013459032995310109227992454839056422),
            new GammaData(91.5, 0.1415337230062888635284098368255351501597e140, 320.4066957540054114483446541626587380014),
            new GammaData(92.5, 0.1295033565507543101284950006953646623961e142, 324.9230347262868870790740563815487018843),
            new GammaData(93.5, 0.1197906048094477368688578756432123127164e144, 329.4502433708052665886256792643481601196),
            new GammaData(94.5, 0.1120042154968336339723821137264035123898e146, 333.988204807099907903519925338728239387),
            new GammaData(95.5, 0.1058439836445077841039010974714513192084e148, 338.5368046415996049733937816714808196625),
            new GammaData(96.5, 0.101081004380504933819225548085236009844e150, 343.095930889086289536826499502225010241),
            new GammaData(97.5, 0.9754316922718726113555265390225274949948e151, 347.6654738974312297792641984341498924371),
            new GammaData(98.5, 0.95104589996507579607163837554696430762e153, 352.245326275435031271896458324405747818),
            new GammaData(99.5, 0.9367802114655996591305637999137598430057e155, 356.835382823613074469259023532110402225),

            // added from functions.wolfram.com
            new GammaData(150.5, 4.6610726270973779184446372799846487869209388208565052e261, 602.51395487058541195073787783078310078992611427542490160614),
            new GammaData(160.5, 3.7244054830528196349088294605798532631823246256960616e283, 652.94648855454370356535399513756610155371294375245598323620)
                  
        };

        private static readonly GammaData[] _Near1 = {
            new GammaData(0.5, 1.772453850905516027298167483341145182798, 0.5723649429247000870717136756765293558236),
            new GammaData(0.625, 1.434518848090556775636019739456423136632, 0.3608294954889401811849576858227794878574),
            new GammaData(0.75, 1.225416702465177645129098303362890526851, 0.2032809514312953714814329718624296997597),
            new GammaData(0.875, 1.089652357422896951252376755102892971148, 0.08585870722533432350236558376948770226972),
            new GammaData(0.875, 1.089652357422896951252376755102892971148, 0.08585870722533432350236558376948770226972),
            new GammaData(0.9375, 1.040177011186767171459762817361921128614, 0.03939090173458230065822754634095384450336),
            new GammaData(0.96875, 1.019032525056673950564730047928136024882, 0.01885367233441289053559206570480080890174),
            new GammaData(0.984375, 1.009263984715686303151364227987264939567, 0.009221337197578781045045446027854805411837),
            new GammaData(0.9921875, 1.004570300975031369541819081985749775618, 0.004559888861804558865096599455042458443847),
            new GammaData(0.99609375, 1.002269894807266338070518646683408822875, 0.002267322487909119869224853055660925945503),
            new GammaData(0.998046875, 1.001131154070271719475148653701632936175, 0.001130514797538261731446855551493110644591),
            new GammaData(0.9990234375, 1.000564631256105134179583334797007222469, 0.0005644719118551233842574575277837954032273),
            new GammaData(0.99951171875, 1.000282079501403060312266009234616105409, 0.0002820397244605020216499093258679218227703),
            new GammaData(0.999755859375, 1.000140980758729162527664293184201592009, 0.0001409708218759223705137152436852900410971),
            new GammaData(0.9998779296875, 1.000070475636328154358952919083132410835, 0.7047315303717008615499045661742960649129e-4),
            new GammaData(0.99993896484375, 1.000035234133024267207862236519063784064, 0.3523351231678223923789189421658142521323e-4),
            new GammaData(0.999969482421875, 1.00001761614530457531538182039987833925, 0.1761599014210985977615986870219441253152e-4),
            new GammaData(0.9999847412109375, 1.000008807842360071243230645907272632701, 0.8807803571255486980463673710461571970668e-5),
            new GammaData(0.99999237060546875, 1.000004403863608190592851185888812529877, 0.4403853911211722516241836921789602523957e-5),
            new GammaData(0.999996185302734375, 1.000002201917411285169225005738085227502, 0.2201914987068584780432891571768087250967e-5),
            new GammaData(1, 1, 0),
            new GammaData(1.000003814697265625, 0.9999977981113740328314320876032760067576, -0.2201891050127487637714181831108975522931e-5),
            new GammaData(1.00000762939453125, 0.9999955962515330814147665236857616584616, -0.4403758163447332570221840098229107074209e-5),
            new GammaData(1.0000152587890625, 0.9999911926182050168670695717547199129391, -0.8807420580197905194061157631901679899078e-5),
            new GammaData(1.000030517578125, 0.99998238569695577840308912119540189507, -0.1761445817787918059338915122874759423839e-4),
            new GammaData(1.00006103515625, 0.9999647732360171681023427372223702590454, -0.352273844598538899122262467277208094941e-4),
            new GammaData(1.0001220703125, 0.9999295538398379138630109146622273453912, -0.7044864160936656733821449407577769386531e-4),
            new GammaData(1.000244140625, 0.9998591371459403420587898072239427065107, -0.0001408727761632663509703058417841195184664),
            new GammaData(1.00048828125, 0.9997183921173586652300583206642029951561, -0.0002816475415868068318239205463917072406589),
            new GammaData(1.0009765625, 0.999437255220281084345213592031181905165, -0.0005629031799912046317021499216851450277288),
            new GammaData(1.001953125, 0.998876391856702293840181665944397250951, -0.001124239864176365593088235002674045499535),
            new GammaData(1.00390625, 0.9977602892435009045255150050890440579513, -0.002242222659961150144765481909230529929808),
            new GammaData(1.0078125, 0.995550440714294209465143243929765941358, -0.004459488037952299086670078922352109198758),
            new GammaData(1.015625, 0.9912190698420517341764818662191450397148, -0.008819709705733069204889229698627066380001),
            new GammaData(1.03125, 0.98290109928362691478263486825456935047, -0.01724677500176806740289126202224623179737),
            new GammaData(1.0625, 0.9675800675995248847599762987154317516646, -0.03295710029357781908319883575047418315706),
            new GammaData(1.125, 0.9417426998497014880874037301518917030763, -0.06002318412603958293140584320743011427822),
            new GammaData(1.125, 0.9417426998497014880874037301518917030763, -0.06002318412603958293140584320743011427822),
            new GammaData(1.25, 0.9064024770554770779826712889669180007488, -0.09827183642181316146385380269663584022562),
            new GammaData(1.375, 0.8889135691562253407424275640662446912078, -0.1177552707410787744513620333179885042465),
            new GammaData(1.5, 0.8862269254527580136490837416705725913988, -0.1207822376352452223455184457816472122519) 
        };

        private static readonly GammaData[] _Near2 = {
            new GammaData(1.5, 0.8862269254527580136490837416705725913988, -0.1207822376352452223455184457816472122519),
            new GammaData(1.625, 0.8965742800565979847725123371602644603951, -0.1091741337567953724659793453255625768435),
            new GammaData(1.75, 0.9190625268488832338468237275221678951384, -0.08440112102048555595778603413139773174384),
            new GammaData(1.875, 0.9534458127450348323458296607150313497544, -0.0476726853991882996439780371618622723197),
            new GammaData(1.875, 0.9534458127450348323458296607150313497544, -0.0476726853991882996439780371618622723197),
            new GammaData(1.9375, 0.9751659479875942232435276412768010580753, -0.02514761940298887101469636934303908362555),
            new GammaData(1.96875, 0.9871877586486528896095822339303817741048, -0.01289502598016741062140421704372482102582),
            new GammaData(1.984375, 0.9934942349545037046646241619249639248858, -0.006527019770560387562504065432973464109098),
            new GammaData(1.9921875, 0.9967220954986639369672736204077361054958, -0.003283288599221334008087443035901123210745),
            new GammaData(1.99609375, 0.9983547780306754539374306832198017571606, -0.001646576833227209223092930587911738897203),
            new GammaData(1.998046875, 0.9991758197849782200230487539873719343464, -0.0008245200382650888261806366903737014930725),
            new GammaData(1.9990234375, 0.9995875173583940940094860854466195201034, -0.0004125677359714894017106176239696704326377),
            new GammaData(1.99951171875, 0.9997936605172715158492229105972945155141, -0.0002063607736483724433350542340289891606905),
            new GammaData(1.999755859375, 0.9998968057145986134157190626438734177924, -0.0001031996102979920861817501746961436019694),
            new GammaData(1.9998779296875, 0.9999483967208452041447977734631271456482, -0.5160461064981215542788033369454594603258e-4),
            new GammaData(1.99993896484375, 0.9999741968262534527384281628962293685498, -0.2580350665416168648325053559023655125278e-4),
            new GammaData(1.999969482421875, 0.9999870980295774847216527132886600812439, -0.1290205365365156795229453393309637521044e-4),
            new GammaData(1.9999847412109375, 0.9999935489189005625751513729787156979985, -0.6451101907750591399976874019296260011728e-5),
            new GammaData(1.99999237060546875, 0.9999967744354781276641509840822795646932, -0.3225569724016764801116581064181763189594e-5),
            new GammaData(1.999996185302734375, 0.9999983872117460118412633921783404380531, -0.1612789554532533173009818453505550062943e-5),
            new GammaData(2, 1, 0),
            new GammaData(2.000003814697265625, 1.00000161280024011931074434129623713986, 0.161279893955840184299760314572495677042e-5),
            new GammaData(2.00000762939453125, 1.000003225612466396944257297966490462185, 0.322560726412023958566345675090317173141e-5),
            new GammaData(2.0000152587890625, 1.000006451272877535864519325623917830418, 0.6451252068164492211696167502987139983584e-5),
            new GammaData(2.000030517578125, 1.000012902737534909133631207655399313341, 0.1290265429530719797568036294024708700466e-4),
            new GammaData(2.00006103515625, 1.000025806242196124228325546227327679105, 0.2580590922078463500093254292124318294867e-4),
            new GammaData(2.0001220703125, 1.000051615552953128452105520486771074315, 0.5161422091631080428484087308642550680092e-4),
            new GammaData(2.000244140625, 1.000103243380595112650112753954221989398, 0.0001032380513640963581901732440393341809948),
            new GammaData(2.00048828125, 1.000206535863509719265815185078589813025, 0.0002065145379145443567131291462537026096587),
            new GammaData(2.0009765625, 1.000413268164832140091644464679649856244, 0.000413182793064254264258674986332041644883),
            new GammaData(2.001953125, 1.000827322309547415507838270760694901832, 0.000826980267085383846585814529167493000815),
            new GammaData(2.00390625, 1.001657790373358329933817798077673136303, 0.001656417755696172869171861186612377080916),
            new GammaData(2.0078125, 1.003328178532374632976589675522967237775, 0.003322652404102649860792821138784654479368),
            new GammaData(2.015625, 1.00670686780833379252298939537881918096, 0.006684476830232184945964816343819769497868),
            new GammaData(2.03125, 1.013616758636240255869592207887524642672, 0.01352488366498562096813694557452593229433),
            new GammaData(2.0625, 1.028053821824495190057474817385146236144, 0.02766752152285702349740729628994608012915),
            new GammaData(2.125, 1.059460537330914174098329196420878165961, 0.05775985153034387160738826626309159079026),
            new GammaData(2.125, 1.059460537330914174098329196420878165961, 0.05775985153034387160738826626309159079026),
            new GammaData(2.25, 1.133003096319346347478339111208647500936, 0.124871714892396594302441287613198663149),
            new GammaData(2.375, 1.222256157589809843520837900591086450411, 0.2006984603774558413588851802726110913487),
            new GammaData(2.5, 1.329340388179137020473625612505858887098, 0.2846828704729191596324946696827019243201) 
        };

        private static readonly GammaData[] _Near0 = {
            new GammaData(-0.5, -3.544907701811032054596334966682290365595, 1.265512123484645396488945797134705923899),
            new GammaData(-0.375, -3.825383594908151401696052638550461697686, 1.341658748500666418041408813274783487436),
            new GammaData(-0.25, -4.901666809860710580516393213451562107405, 1.589575312551185990315897214778782835911),
            new GammaData(-0.125, -8.717218859383175610019014040823143769183, 2.165300248905170251754061948144017406496),
            new GammaData(-0.125, -8.717218859383175610019014040823143769183, 2.165300248905170251754061948144017406496),
            new GammaData(-0.0625, -16.64283217898827474335620507779073805782, 2.811979623974363538327156032173660116805),
            new GammaData(-0.03125, -32.60904080181356641807136153370035279623, 3.484589575134139437621752672995683649279),
            new GammaData(-0.015625, -64.59289502180392340168731059118495613226, 4.168104420557250637548438174776914213865),
            new GammaData(-0.0078125, -128.5849985248040153013528424941759712791, 4.856590152781421724785721449662278434972),
            new GammaData(-0.00390625, -256.581093070660182546052773550952658656, 5.54744476696747159520708182472107347055),
            new GammaData(-0.001953125, -512.5791508839791203712761106952360633215, 6.239455139837046046486535948675082223324),
            new GammaData(-0.0009765625, -1024.578182406251657399893334832135395808, 6.932036277511308217556578672109549476158),
            new GammaData(-0.00048828125, -2048.577698818873467519520786912493783878, 7.624901025883858905611203245365810170653),
            new GammaData(-0.000244140625, -4096.57745718775464971331294488248972087, 8.317907137541219635377299172741804106947),
            new GammaData(-0.0001220703125, -8192.577336412800240508542313129020709561, 9.010983820432326192510172569412912814588),
            new GammaData(-0.6103515625e-4, -16384.5772760354695939336148831283410381, 9.704095761351551114080487592308688534482),
            new GammaData(-0.30517578125e-4, -32768.57724584934032393443149086321342054, 10.39722532438932175111825798174135071555),
            new GammaData(-0.152587890625e-4, -65536.57723075690962899636361017901925666, 11.09036369676269620616269440700453555078),
            new GammaData(-0.762939453125e-5, -131072.577223210852757386190636818435916, 11.78350647337298147181546230662592344689),
            new GammaData(-0.3814697265625e-5, -262144.5772194378639394013199042046138782, 12.47665145199400263809495861913874999345),
            new GammaData(0.3814697265625e-5, 262143.4227881080344625629331726731855155, 12.47664704818796544202254047206534711638),
            new GammaData(0.762939453125e-5, 131071.4227918809440471962777925401520979, 11.78349766576090681276037584294890342818),
            new GammaData(0.152587890625e-4, 65535.42279942668398540027145451732421438, 11.09034608153854475277051988217319318753),
            new GammaData(0.30517578125e-4, 32767.42281451784694671242432333092929765, 10.39719009394100176207788843272141977354),
            new GammaData(0.6103515625e-4, 16383.4228446989052821887834066513143242, 9.704025300454774477951337474167744232248),
            new GammaData(0.0001220703125, 8191.422905055952190365785412912966413445, 9.010842898637679655856679364462219607288),
            new GammaData(0.000244140625, 4095.423025749771641072803050389269325868, 8.317625293943180446655815151656334697388),
            new GammaData(0.00048828125, 2047.42326705635054639115944072028773408, 7.62433733861781159675772941549355054159),
            new GammaData(0.0009765625, 1023.423749345567830369498718239930270889, 6.930908902419461889540619064660080535727),
            new GammaData(0.001953125, 511.4247126306315744461730129635313924869, 6.23720038517533141916200085812091506718),
            new GammaData(0.00390625, 255.4266340463362315585318413027952788355, 5.542935221819601325193091489756182014674),
            new GammaData(0.0078125, 127.4304564114296588115383352230100404938, 4.84757077588166486683395477128488386733),
            new GammaData(0.015625, 63.43802046989131098729483943802528254174, 4.150063373653938787298503499050432342073),
            new GammaData(0.03125, 31.45283517707606127304431578414621921504, 3.44848912779795847968326934526863660858),
            new GammaData(0.0625, 15.48128108159239815615962077944690802663, 2.739631621946203418585729650082232089145),
            new GammaData(0.125, 7.53394159879761190469922984121513362461, 2.019418357553796345320290521167099589948),
            new GammaData(0.125, 7.53394159879761190469922984121513362461, 2.019418357553796345320290521167099589948),
            new GammaData(0.25, 3.625609908221908311930685155867672002995, 1.288022524698077457370610440219717295925),
            new GammaData(0.375, 2.370436184416600908646473504176652509887, 0.8630739822706474624050890941340154953325),
            new GammaData(0.5, 1.772453850905516027298167483341145182798, 0.5723649429247000870717136756765293558236) 
        };

        private static readonly GammaData[] _NearN10 = {
            new GammaData(-10.5, -0.2640121820547716316246385325311240439682e-6, -15.14727059071784114610117639552631963436),
            new GammaData(-10.375, -0.3853824777091100016167565620752110328498e-6, -14.76902954720701012688042720516103787762),
            new GammaData(-10.25, -0.67808180432946731304891004492754985848e-6, -14.20399790093109065161116876070387206737),
            new GammaData(-10.125, -0.1684831262052517456216882327889895477394e-5, -13.293845140389538484236785089823191703),
            new GammaData(-10.125, -0.1684831262052517456216882327889895477394e-5, -13.293845140389538484236785089823191703),
            new GammaData(-10.0625, -0.3830328107020316635889325503807551568979e-5, -12.47256009081165579039929355805785844157),
            new GammaData(-10.03125, -0.820629952953019778657392524711140975814e-5, -11.71060846332720387792243958913415617938),
            new GammaData(-10.015625, -0.1700699874643038383461557487368349913225e-4, -10.98188560766303889037266091827081352261),
            new GammaData(-10.0078125, -0.3463458256516313677243695342138690766685e-4, -10.27065787896126424410583159193311350064),
            new GammaData(-10.00390625, -0.6990332874758209033426446699035926999779e-4, -9.568397288290682386853008683681967849367),
            new GammaData(-10.001953125, -0.0001404477363900451708521851118608466504012, -8.870675121382310094805966387146254501189),
            new GammaData(-10.0009765625, -0.000281540041401883411812666338203440274148, -8.175235877509399161097817609681419866606),
            new GammaData(-10.00048828125, -0.000563726404385624063397951573975953521758, -7.480941522771659111292091779019988346536),
            new GammaData(-10.000244140625, -0.001128100008866690679009902807702968873353, -6.787220469493554911614571257238006425123),
            new GammaData(-10.0001220703125, -0.002256847657595184957233851276605048793085, -6.093786281167310238545736320487058532071),
            new GammaData(-10.00006103515625, -0.004514343175062893955072428860155326550553, -5.400495578872419834979145899538225218653),
            new GammaData(-10.000030517578125, -0.009029334320035575647839997474459714791226, -4.707276632982054173483611347195057396393),
            new GammaData(-10.0000152587890625, -0.01805931666500754906434806474181437991942, -4.01409356864116185854622778461065066607),
            new GammaData(-10.00000762939453125, -0.03611928138246679574769960801636554264536, -3.320928445911808853642423587159533484381),
            new GammaData(-10.000003814697265625, -0.07223921083114343778444263107651750106133, -2.627772294197426150094657771000510514181),
            new GammaData(-9.999996185302734375, 0.07224050699108014022628046448675851453374, -2.627754351749084271591553302449947161499),
            new GammaData(-9.99999237060546875, 0.03612057754240364069840471083444586728855, -3.320892561015125097640948165422843317137),
            new GammaData(-9.9999847412109375, 0.01806061282494496405052242015364798732676, -4.014021798847794354581145064057511795502),
            new GammaData(-9.999969482421875, 0.009030630479975270775894162659645956519741, -4.707133093395319229856390889602684453056),
            new GammaData(-9.99993896484375, 0.004515639335011709650690623512369371764253, -5.400208499698950462148264857327856480671),
            new GammaData(-9.9998779296875, 0.002258143817580482923824809786660261248415, -6.093212122820375608272453375481778776963),
            new GammaData(-9.999755859375, 0.00112939616899791774095825334343857186485, -6.786072152799718574175843462405206935614),
            new GammaData(-9.99951171875, 0.0005650225651005676902373042742306456894427, -7.478644889384249821277500306107773873963),
            new GammaData(-9.9990234375, 0.000282836204451696233602080064105049188933, -8.170642610736687659976646968506313698216),
            new GammaData(-9.998046875, 0.0001417439087793817388175538505551912206884, -8.861488587853743723990903404527520549863),
            new GammaData(-9.99609375, 0.7119953849576511774290270246050426493188e-4, -9.550024221368402701862865053477154735263),
            new GammaData(-9.9921875, 0.3593094176075641243360143967272818899195e-4, -10.23391174619552949434163600960412224542),
            new GammaData(-9.984375, 0.1830395592410737084371847753712605958898e-4, -10.90839335076217169965796414369624068766),
            new GammaData(-9.96875, 0.9505651717966543211040666528035462899479e-5, -11.56362401857045907442600014919001566007),
            new GammaData(-9.9375, 0.5139309871979484321498376816774659227047e-5, -12.17859175366355833461560769108992933228),
            new GammaData(-9.875, 0.3033137834984411836791652786842133042328e-5, -12.70591288519170921633064985576606088605),
            new GammaData(-9.875, 0.3033137834984411836791652786842133042328e-5, -12.70591288519170921633064985576606088605),
            new GammaData(-9.75, 0.2197547155462853887868709703817446704567e-5, -13.02816874893114553892881831326149507953),
            new GammaData(-9.625, 0.2248214426276410648574460028763198846825e-5, -13.00537424512744790544056216033820032846),
            new GammaData(-9.5, 0.2772127911575102132058704591576802461667e-5, -12.79589533355436345901781053661879076815) 
        };

        private static readonly GammaData[] _NearN55 = new GammaData[] {
                  new GammaData(-55.5, 0.3313939247684676728377268347296671102738e-73, -169.1931592947433577934436950412776436064),
                  new GammaData(-55.375, 0.5931885913251829148011431845907438457576e-73, -168.6109546898941580979033836431457031234),
                  new GammaData(-55.25, 0.128134265213561204650151776242601279892e-72, -167.8408033134133338381597995376176917559),
                  new GammaData(-55.125, 0.3913191103476296924523858848738104144085e-72, -166.7243586084319013982262850893209212539),
                  new GammaData(-55.125, 0.3913191103476296924523858848738104144085e-72, -166.7243586084319013982262850893209212539),
                  new GammaData(-55.0625, 0.986732607487198018754292852511389106856e-72, -165.7994828862238820223463651561184383051),
                  new GammaData(-55.03125, 0.2226660343675615375290464186909601183619e-71, -164.9856238363615162450940197678605306484),
                  new GammaData(-55.015625, 0.4736069454740001055763353712089973133951e-71, -164.2309191328226253115354307486462442346),
                  new GammaData(-55.0078125, 0.977114118293834733521912343859491871413e-71, -163.5066934315334134525852432438180103697),
                  new GammaData(-55.00390625, 0.1984981336813056540008261636773673389822e-70, -162.7979320905915813518737104001603528406),
                  new GammaData(-55.001953125, 0.4001152702583918680236220298606474660766e-70, -162.0969591073259992663458061954608696748),
                  new GammaData(-55.0009765625, 0.8033716579133006533597549451686567408424e-70, -161.399894344940666691934457343256688548),
                  new GammaData(-55.00048828125, 0.1609895558223411179719291838965309144853e-69, -160.7047872033597077904481004857770657217),
                  new GammaData(-55.000244140625, 0.3222948938373906907742658942729222148632e-69, -160.0106597497627978468127607946271352327),
                  new GammaData(-55.0001220703125, 0.6449058492709206027088103024110200975353e-69, -159.3170223595527956784727838139907674684),
                  new GammaData(-55.00006103515625, 0.1290127899946570906748117205135768082314e-68, -158.6236300558849309281660984198839415596),
                  new GammaData(-55.000030517578125, 0.2580572071228903781598785159467838581806e-68, -157.9303603092003033255947568117785799832),
                  new GammaData(-55.0000152587890625, 0.5161460448765772204325064962419091742529e-68, -157.2371518444353362397006108889220356827),
                  new GammaData(-55.00000762939453125, 0.1032323722132728230665906965174285853426e-67, -156.5439740214872098856520824742320518588),
                  new GammaData(-55.000003814697265625, 0.2064679077519460715554797358664728667652e-67, -155.8508115196617565149201605014267824236),
                  new GammaData(-54.999996185302734375, -0.2064742345776389872444192676691131506575e-67, -155.8507808769879053144034254273344043224),
                  new GammaData(-54.99999237060546875, -0.1032386990389669331883069223703195417382e-67, -156.543912736139507484654652677755511734),
                  new GammaData(-54.9999847412109375, -0.5162093131335660989607568848213731056733e-68, -157.2370292737399314379940741096346901828),
                  new GammaData(-54.999969482421875, -0.258120475380070365932807313377307528986e-68, -157.9301151678094937244882657625299630878),
                  new GammaData(-54.99993896484375, -0.129076058252601515431668371755594450098e-68, -158.6231397731033117444057763960015760334),
                  new GammaData(-54.9998779296875, -0.6455385318809423304687659289501264852653e-69, -159.3160417939895574585734203633457962732),
                  new GammaData(-54.999755859375, -0.3229275765697223526481784197301709161285e-69, -160.0086986186363225879842786767213113941),
                  new GammaData(-54.99951171875, -0.1616222390439127298761439614470246404862e-69, -160.70086494110676672055309472267163668),
                  new GammaData(-54.9990234375, -0.8096985096986489455731873769112931053315e-70, -161.3920498204348601342401201789602276343),
                  new GammaData(-54.998046875, -0.4064422003228156070372890110113661523823e-70, -162.0812700583149908077227373306519861132),
                  new GammaData(-54.99609375, -0.2048253768707794232109022149495560465895e-70, -162.7665539925744016887591545718340828031),
                  new GammaData(-54.9921875, -0.1040399076590405899054222579682253865197e-70, -163.4439372355377521596244089121137210432),
                  new GammaData(-54.984375, -0.5369420317824801296090020359957584504561e-71, -164.1054067411408869986598886088213583004),
                  new GammaData(-54.96875, -0.2862019916619447982849309567142574291595e-71, -164.7345990554747140245090340482576614581),
                  new GammaData(-54.9375, -0.1630184748946170270451320476784206632433e-71, -165.2974333442636798880161449262335724888),
                  new GammaData(-54.875, -0.1068084665867092473960298264876009169786e-71, -165.7202596830189416811721153572453840111),
                  new GammaData(-54.875, -0.1068084665867092473960298264876009169786e-71, -165.7202596830189416811721153572453840111),
                  new GammaData(-54.75, -0.9545836185625177195542164628822374598687e-72, -165.8326067306542059861208673933569437798),
                  new GammaData(-54.625, -0.1206186475649396145903288691554707530168e-71, -165.5986629859610336595561650158366255984),
                  new GammaData(-54.5, -0.183923628246499558424938393274965246202e-71, -165.1767762739909689670975862547818473059) 
               };

        #endregion

        static TestCase<double>[] GetTgammaFactorials()
        {
            int Max = Math2.FactorialTable.Length;

            TestCase<double>[] partialData = new TestCase<double>[Max];

            for (int i = 0; i < Max; i++) {
                partialData[i] = new TestCase<double>(i + 1, BigInt.Factorial(i));
            }

            return partialData;

        }

        static IEnumerable<TestCase<double>> GetTgammaData(GammaData[] data)
        {
            return data.Select(d => new TestCase<double>(d.X, d.Tgamma));
        }

        static IEnumerable<TestCase<double>> GetLgammaData(GammaData[] data)
        {
            return data.Select(d => new TestCase<double>(d.X, d.Lgamma));
        }

        /// <summary>
        /// Spot values computed from wolfram
        /// </summary>
        private static readonly TestCase1[] _TgammaEtc = {

            new TestCase1(142.75, 7.8029496083318133344429227511387928576820621466e244),

            // MinNormal = 2^-1022
            new TestCase1(Math.Pow(2,-1022), 4.4942328371557897693232629769725618340449424473557664318e307),
            new TestCase1(128*Math.Pow(2,-1022), 3.5111194040279607572837992007598139328476112869e305),
            new TestCase1(256*Math.Pow(2,-1022), 1.7555597020139803786418996003799069664238056434983462624e305),

            new TestCase1(-Math.Pow(2,-1022), -4.49423283715578976932326297697256183404494244735576643e307),
            new TestCase1(-128*Math.Pow(2,-1022), -3.51111940402796075728379920075981393284761128699669252e305 ),
            new TestCase1(-256*Math.Pow(2,-1022), -1.75555970201398037864189960037990696642380564349834626e305),
 
            new TestCase1(Math.Pow(2,-52), 4.5035996273704954227843350984673590080356412508301396991e15),
            new TestCase1(-Math.Pow(2,-52), -4.503599627370496577215664901533080221059821415724486129e15),
            new TestCase1(-1+Math.Pow(2,-52), -4.503599627370496422784335098467452885016296682083256307e15),
            new TestCase1(-1-Math.Pow(2,-52), 4.5035996273704955772156649015331740980404768468383845327e15),

            new TestCase1(Math.Pow(2,-39), 5.4975581388742278433510026622176849998952895284077307836e11),
            new TestCase1(-Math.Pow(2,-39), -5.497558138885772156649033319429815301748865419560024009e11),
            new TestCase1(-1+Math.Pow(2,-39), -5.497558138884227843351010352619940339531720437310882433e11),
            new TestCase1(-1-Math.Pow(2,-39), 5.4975581388757721566490410098320705479575403805262650237e11),


            new TestCase1(-170+Math.Pow(2,-44), 2.424029017618076748711042669490986666444726563600894442e-294),
            new TestCase1(-170-Math.Pow(2,-44), -2.4240290176166606146483370985803129365642001440493090e-294),
            new TestCase1(-170.75, -1.29531017388359842803755523180179652040836164340239931e-308),
            new TestCase1(-170.875, -1.25833249169631076786244842683061019937988232775957838e-308),
            new TestCase1(-170.9375, -1.78966869552647696440747772019162770731932111734844950e-308),

            new TestCase1(-171+Math.Pow(2,-44), -1.41756082901641962251525281522626500197276481294182711e-296),
            new TestCase1(-171-Math.Pow(2,-44), 1.417560829015590531496080382751853877427501025332183681e-296),

            //Denorm results
            new TestCase1(-170.5, -3.31273952153860731481015406509295615598015020801475320e-308),

            new TestCase1(-172.5, -1.11978350328765194230283654543219035990371410251058544e-312),
            new TestCase1(-173.5, 6.454083592436034249584072307966515042672703760867927621e-315),


            //
            new TestCase1(Math.Pow(2,-25), 3.35544314227843645746319656372890833248893111091576093784e7),
            new TestCase1(Math.Pow(2,-26), 6.71088634227843498365497540162116779371244347268015353916e7),
            new TestCase1(Math.Pow(2,-27), 1.34217727422784342467508497080056807355928046680073490038e8),

            new TestCase1(-Math.Pow(2,-25), -3.3554432577215694377699298856976672393842050893707153302e7),
            new TestCase1(-Math.Pow(2,-26), -6.7108864577215679639615878230901710327675769666561360586e7),
            new TestCase1(-Math.Pow(2,-27), -1.3421772857721567227057431904349745057715137094265141496e8),


        };



        /// <summary>
        ///A test for Tgamma
        ///</summary>
        [TestMethod()]
        public void TgammaTest()
        {


            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetTgammaFactorials(),        "Tgamma: Factorials",    1),
                new TestCaseSet<double>(GetTgammaData(_Near0),        "Tgamma: Near 0",        5),
                new TestCaseSet<double>(GetTgammaData(_Near1),        "Tgamma: Near 1",        5),
                new TestCaseSet<double>(GetTgammaData(_Near2),        "Tgamma: Near 2",        5),
                new TestCaseSet<double>(GetTgammaData(_NearN10),    "Tgamma: Near -10",        5),
                new TestCaseSet<double>(GetTgammaData(_NearN55),    "Tgamma: Near -55",        5),
                new TestCaseSet<double>(_TgammaEtc,                "Tgamma: Etc",        5),
            };

            NumericFunctionTest.RunSet(Math2.Tgamma, "Tgamma", testCases);


        }

        /// <summary>
        ///A test for Tgamma
        ///</summary>
        [TestMethod()]
        public void TgammaIntTest()
        {
            Assert2.AreEqual<Exceptions.PoleException>(double.NaN, () => Math2.Tgamma(-1));
            Assert2.AreEqual<Exceptions.PoleException>(double.NaN, () => Math2.Tgamma(0));
            Assert.AreEqual(double.PositiveInfinity, Math2.Tgamma(int.MaxValue));

            IEnumerable<TestCase<int>> GetFactorials()
            {
                for (int i = 0; i < Math2.FactorialTable.Length; i++) {
                    yield return new TestCase<int>(i + 1, BigInt.Factorial(i));
                }
            }

            TestCaseSet<int>[] testCases = {
                new TestCaseSet<int>(GetFactorials(),        "Tgamma: Factorials",    1),
            };

            NumericFunctionTest.RunSet(Math2.Tgamma, "Tgamma", testCases);


        }


        /// <summary>
        /// Spot values computed from wolfram
        /// </summary>
        private static readonly TestCase1[] _LgammaTricky = {

            new TestCase1(-2.4548671245575, 0.0032927179979550855679055124918697406652151916171332),
            new TestCase1(-2.74675607681274, -0.00176557462286000695324013346703028750606624938746),
            new TestCase1(-2.74852275848389, 0.0016150380950108832343693537551934457051999327583902),
           
        };


        /// <summary>
        ///A test for Lgamma
        ///</summary>
        [TestMethod()]
        public void LgammaTest()
        {

            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetLgammaData(_Factorials), "Lgamma: Factorials",    5),
                new TestCaseSet<double>(GetLgammaData(_Near0),        "Lgamma: Near 0",        5),
                new TestCaseSet<double>(GetLgammaData(_Near1),        "Lgamma: Near 1",        5),
                new TestCaseSet<double>(GetLgammaData(_Near2),        "Lgamma: Near 2",        5),
                new TestCaseSet<double>(GetLgammaData(_NearN10),    "Lgamma: Near -10",        10),
                new TestCaseSet<double>(GetLgammaData(_NearN55),    "Lgamma: Near -55",        10),
 
                // added to test set: Rocco Romeo
                new TestCaseSet<double>(_LgammaTricky,    "Lgamma: Tricky cases",    2500),

            };

            NumericFunctionTest.RunSet(Math2.Lgamma, "Lgamma", testCases);

        }

    }
}
