//  Copyright (c) 2013 Rocco Romeo
//  Use, modification and distribution are subject to the
//  Boost Software License, Version 1.0. (See accompanying file
//  LICENSE_1_0.txt or copy at http://www.boost.org/LICENSE_1_0.txt)

//  Test Data:
//      Copyright (c) 2013 John Maddock, Boost Software License v1.0

using System.Collections.Generic;
using System.Linq;
using Microsoft.VisualStudio.TestTools.UnitTesting;

namespace MathXK.Test.Functions
{
    [TestClass]
    public class T_Airy
    {

        struct AiryData
        {
            public readonly double X;
            public readonly double Ai;
            public readonly double Bi;
            public readonly double AiPrime;
            public readonly double BiPrime;

            public AiryData(double x, double ai, double bi, double aiPrime, double biPrime)
            {
                X = x;
                Ai = ai;
                Bi = bi;
                AiPrime = aiPrime;
                BiPrime = biPrime;

            }
        }

        #region Test Case Data

        private static readonly AiryData[] _dataPos = new AiryData[] {
   
            // Values are x, Ai, Bi, Ai', Bi'.
            // Calculated from functions.wolfram.com.

            new AiryData(0.0,0.35502805388781723926006318600418317639797917419918,0.61492662744600073515092236909361355359472818864860,-0.25881940379280679840518356018920396347909113835493,0.44828835735382635791482371039882839086622679921226),
            new AiryData(1.5,0.071749497008105409673555416489677513605751778464395,1.8789415037478950009093350494762590572259540033267,-0.097382012842301319218484218202449941776112431437230,1.8862122548481654886923470240251475957045331001009),
            new AiryData(3.0,0.0065911393574607191442574484079613510717327213478307,14.037328963730232031740267313779686908586968454710,-0.011912976705951318473763232593022287260386875431483,22.922214966382170185104731043307866569046120356853),
            new AiryData(4.5,0.00033025032351430898365873259009933623413378577640945,227.58808183559971846141088605447014070932477186282,-0.00071786656755750888869355429846677460954382827694839,469.13507732796639795091967714514872184464841499310),
            new AiryData(6.0,9.9476943602528895702388476688287790473427034138148e-6,6536.4461048098634537583500246194567080926151012063,-0.000024765200397034954754181825386985403876372193670113,15725.602621930476839420322957323972083282121190170),
            new AiryData(7.5,1.9172560675134307516450028989310386760973797391224e-7,303229.61511253340229383059130590574191046352885100,-5.3127139597205446847895442804099785400399019117480e-7,819987.83535879962093208297441867846933220345505758),
            new AiryData(9.0,2.4711684308724898432892411343390964580650992064067e-9,2.1472868891435349093368128811111401222732211578233e7,-7.4806413896589464127595452734191222566910371212477e-9,6.3807489780908213854513533677657766821270955200127e7),
            new AiryData(10.5,2.2022745192834016435303043963557860427696429139204e-11,2.2305544411366952291506515527005037146319487173585e9,-7.1876967814515670913378529783383612625448746343633e-11,7.1736922452832991801436008722895220552055294643360e9),
            new AiryData(12.0,1.3931846888753608390490345031955322806493669673121e-13,3.2980722582907417618476811182361947497769626066032e11,-4.8547365549853084629936539976954805457733080901824e-13,1.1355075024433707424043240904582373796149956382291e12),
            new AiryData(13.5,6.3916738767418666506787202533616851448370415888180e-16,6.7774490265707907220803416820302549920733896887952e13,-2.3601425439243112854396504363753340148410122211120e-15,2.4774797864941903860620591047148167446443200016558e14),
            new AiryData(15.0,2.1649625207379922989894540388084597725790674881510e-18,1.8982099567493589684789526625799099370384922724423e16,-8.4205679540177727661243928068391172899020467940634e-18,7.3197492034070104961888777181436356003802038176647e16),
            new AiryData(16.5,5.4969111729670607636007127383178662396233170834721e-21,7.1281127151950813135818869310206093161879287085549e18,-2.2411085425252972574842456066792692410672239747450e-20,2.8845498537888041718830097027348149068200996974792e19),
            new AiryData(18.0,1.0600466825247955656341255852940331129955903625165e-23,3.5389182503565686699885529929749933285152374790142e21,-4.5120018606819418891689416874196559953511996130957e-23,1.4964796503287850684264052919631675347644399502339e22),
            new AiryData(19.5,1.5705905615178183775785499108562608404766556519409e-26,2.2948219685486486669676369815830596813809500934027e24,-6.9555322364636242578553707908457313095260484353054e-26,1.0104021269463098590208460455392526406419411133432e25),
            new AiryData(21.0,1.8061384424703833794802403570055066273919807465560e-29,1.9229446248638083512942096795241567286122541540988e27,-8.2981302583004457498614723967061786556458862147433e-29,8.7889960528431639126005727496928744006243213200812e27),
            new AiryData(22.5,1.6268008568516215606903696823223126708960708674820e-32,2.0625307844122523079885004804207955370577106420066e30,-7.7345651805555254101215227839271808586719909618517e-32,9.7603893940464138644587975616266495051051421159858e30),
            new AiryData(24.0,1.1570810853985424658605305871352421417127432074063e-35,2.8077318368107314524649299838065139831493478973685e33,-5.6805061601226782964115644840372833291775239715394e-35,1.3725615969197961430338899208172810409771160571251e34),
            new AiryData(25.5,6.5472206184425666949601287099357524595925016888780e-39,4.8139010532477165620984331258964032945994491874882e36,-3.3125723938345988731890711721358968332998668726589e-38,2.4261581835190947702483348057973507052807552993156e37),
            new AiryData(27.0,2.9672049228631665179692569546061806381600508104870e-42,1.0322720225188874223063376796765456744597943347119e40,-1.5445402062389695003557274037256770596384255305384e-41,5.3542416536194528304076290149630316109482444754061e40),
            new AiryData(28.5,1.0837381856587270138481001354313378389193873852366e-45,2.7509092103664311280341015804325280846594565608191e43,-5.7950465100862229790552719956669554027459405520701e-45,1.4661605551550292004971236211258657048244618847981e44),
            new AiryData(30.0,3.2082175915504955710752869331847527965668519217576e-49,9.0572885121513069518948136873531102381785659940587e46,-1.7598765814327259820821046924047368261943773726313e-48,4.9533045128912990420789216778257661334102190131421e47),
            new AiryData(30.5, 2.04253461666926015963302258449952681287194929082634196439857e-50, 1.41092256201712698413071856671990267572381736486242769613348e48, -1.12969466271996376602221721397236452019046628449363103927812e-49, 7.78046629440950280615411694840600772185863288897663300007879e48 ),
        };


        private static readonly AiryData[] _dataNeg = new AiryData[] {
            new AiryData(-0.5,0.47572809161053958879864377828130715048760981605917,0.38035265975105385016971249372626450267092618501347,-0.20408167033954738614481720179494460837486929239672,0.50593371362384716657026043789690361637305136567619),
            new AiryData(-2.0,0.22740742820168557599192443603787379946077222541710,-0.41230258795639848808323405461146104203453483447240,0.61825902074169104140626429133247528291577794512415,0.27879516692116952268509756941098324140300059345163),
            new AiryData(-3.5,-0.37553382314043191193439695158017023954326857637826,0.16893983748105861184344276954094326991156224392630,-0.34344343345404814628793737409869885709419422095871,-0.69311628490728880175244361267058046269970266801498),
            new AiryData(-5.0,0.35076100902411431978801632769674222148444325089309,-0.13836913490160057685002917560262372343954017874439,0.32719281855444313679487867742662919792754024187630,0.77841177300189924609442320990401745580983676576306),
            new AiryData(-6.5,-0.23802030199711580359444410349613054416644672217509,0.26101265763648395181742026148842931042077710855589,-0.67495249251320217299893875436637135191855976219852,-0.59717066629162201697627414413422434536678781967981),
            new AiryData(-8.0,-0.052705050356386202622082675793888620816383030728544,-0.33125158075113785996987623927570701981243444493069,0.93556093819830655102552246213263573236369879978008,-0.15945049781298138934993573365015622461365602423559),
            new AiryData(-9.5,0.31910324771912820137574776194711089090720124806196,0.037785432489466502265630658944929494701396640946317,-0.10809531881187123899634526876190020136448704898326,0.98471407000211970392066870859714950084095009985210),
            new AiryData(-11.0,-0.0087595892557023812899660884689812923774354213671396,0.30965476742678188633296299321664860072975572955612,-1.0273278736645794214611873140312163593819124450954,-0.022022995314464466559029094897514565932113983920204),
            new AiryData(-12.5,-0.27627456138116024822517113829653348934777724341990,0.11703336725739277660210150953186908969349568491400,-0.41933133041950516440602109372627847959208480457639,-0.97451653616717407215606282578110493110137542619482),
            new AiryData(-14.0,-0.26598348278407779838479143272713124516810627677366,-0.11966555279762452313260097409839057109540372194160,0.44302487700284364117151689206418269134717575380696,-0.99741181894933352405414425721741352501076279734142),
            new AiryData(-15.5,-0.16644795409041976738816182810959129904367094890192,-0.23052653075471221073510916939952349256694065066623,0.90493793543021219950674257010187607628866107330506,-0.65905095668007341198830098511186529626641554956547),
            new AiryData(-17.0,-0.10526230029095239023211303545129788684347682546270,-0.25713592100234318214472612484917229433292008553653,1.0586845766446600773948949171702888275364040980549,-0.43780206579098750946506597954619818117729678077416),
            new AiryData(-18.5,-0.11208853977554047611890939267425397154964541560483,-0.24787069072043292520720236697226902134529394443577,1.0646439622797084435975625719886900495963882004512,-0.48547203836493565857877040369736222967262753998284),
            new AiryData(-20.0,-0.17640612707798468959019229221947750492588351413637,-0.20013930932265134928360479933589026213619747491763,0.89286285673647123839840993411431862501622705810233,-0.79142903383953647935628153146252251289298341460609),
            new AiryData(-21.5,-0.25038504298749525101679062188051056662337948165108,-0.077166876875313811493761526701626716426937008685597,0.35490253223925327952278395572418111544720907163757,-1.1619031340872722585736750957552021910452072248270),
            new AiryData(-23.0,-0.22693405337408287511647774711952252024976540874268,0.12195196890032855671939801904470817236131491613275,-0.58733509004493979460587938698400178552403404370823,-1.0870259966754336822713223103827096605189482540066),
            new AiryData(-24.5,-0.012926044703241092596980387938928322031348870746950,0.25325983212568291535828235610691631627030738823450,-1.2537174187587190878578087926595912764585402716572,-0.061397217333928337728331825148967900823297724901975),
            new AiryData(-26.0,0.23314283498427382051883075910965687623724035603025,0.089830775916643244985674868168561844424527478590379,-0.45581131205669691418694585938555566322808822583262,1.1896741427582941277373591618733309217452576406389),
            new AiryData(-27.5,0.11023300525998052340079884757849660520640263926109,-0.22033506811259788144189726641893007293763067220507,1.1564575976664855882018996164534016386542300009845,0.57606814295634737840388455805128194505351375057257),
            new AiryData(-29.0,-0.22876019353937840878503941983330988426097143247899,-0.082322883718084318521706898533341855252733956120538,0.44135314114626333713749448373688768848218717241073,-1.2326288874994180976148646945530803370200815261067),
            new AiryData( -300.5, -0.117584304761702008955433457721670950077867326839023449546057, 0.0673518035440918806545676478730240310819758211028871823560384, -1.16763702262473888724431076711846459336993902544926162874376, -2.03826035550300900666977975504950803669545593208969273694133 ),
        };
    #endregion


    static IEnumerable<TestCase<double>> GetAiData(AiryData[] data)
        {
            return data.Select(d => TestCase.Create(d.X, d.Ai));
        }

        static IEnumerable<TestCase<double>> GetBiData(AiryData[] data)
        {
            return data.Select(d => TestCase.Create(d.X, d.Bi));
        }

        static IEnumerable<TestCase<double>> GetAiPrimeData(AiryData[] data)
        {
            return data.Select(d => TestCase.Create(d.X, d.AiPrime));
        }

        static IEnumerable<TestCase<double>> GetBiPrimeData(AiryData[] data)
        {
            return data.Select(d => TestCase.Create(d.X, d.BiPrime));
        }

        [TestMethod]
        public void AiryAiTest()
        {
            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetAiData(_dataPos), "Ai: Spot Values", 100),
                new TestCaseSet<double>(GetAiData(_dataNeg), "Ai: Negative Spot Values", 850),
            };

            NumericFunctionTest.RunSet(Math2.AiryAi, "AiryAi", testCases);

        }

        [TestMethod]
        public void AiryBiTest()
        {
            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetBiData(_dataPos), "Bi: Spot Values", 150),
                new TestCaseSet<double>(GetBiData(_dataNeg), "Bi: Negative Spot Values", 800),
            };

            NumericFunctionTest.RunSet(Math2.AiryBi, "AiryBi", testCases);
        }

        [TestMethod]
        public void AiryAiPrimeTest()
        {
            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetAiPrimeData(_dataPos), "AiPrime: Spot Values", 100),
                new TestCaseSet<double>(GetAiPrimeData(_dataNeg), "AiPrime: Negative Spot Values", 800),
            };

            NumericFunctionTest.RunSet(Math2.AiryAiPrime, "AiryAiPrime", testCases);

        }

        [TestMethod]
        public void AiryBiPrimeTest()
        {
            TestCaseSet<double>[] testCases = {
                new TestCaseSet<double>(GetBiPrimeData(_dataPos), "BiPrime: Spot Values", 100),
                new TestCaseSet<double>(GetBiPrimeData(_dataNeg), "BiPrime: Negative Spot Values", 1000),
            };

            NumericFunctionTest.RunSet(Math2.AiryBiPrime, "AiryBiPrime", testCases);
        }
    }
}
